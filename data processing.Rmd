---
title: "CV Growth"
output: html_document
date: '2022-10-25'
editor_options: 
  chunk_output_type: console
---
loading library and import data
```{r}
setwd("C:/Users/alish/OneDrive/Documents/GitHub/CV_growth/data files")
library(readxl)
library(lme4)
library(lmerTest)
sw = read_xlsx("treatment monitoring.xlsx")
mass = read_xlsx("CV mass data_V1.xlsx") 
  mass = mass[mass$CV_ID != "bucket 4" & mass$CV_ID != "bucket 6",]
  mass$CI = mass$gut.wt/mass$shell.wt
  mass$bucket = as.numeric(mass$`Bucket#`)
  #code scores
  #1 = blank tinfoil measurements
  #2 = no gut but only shell weights
  #3 = ID missing for CV
  #4 = bad data
  mass = mass[mass$code == 0,]
sa = read_xlsx("all SA growth data_V1.xlsx")
control = read_xlsx("control cv.xlsx")
library(seacarb)
  
```

seacarb for carbonate system estimates; need to get data from other computer*
```{r}
#inputting another column for pH spec

sw$ph.spec = NA
sw[sw$S > 31,]$ph.spec <- round((0.0221*sw[sw$S > 31,]$pH.mV) + 6.6854,2)
sw[sw$S < 31,]$ph.spec <- round((0.019*sw[sw$S < 31,]$pH.mV) + 6.7915,2)
sw$ph.spec = as.numeric(sw$ph.spec)

#calculating the rest of sea carb using TA and pH measurements

carb = carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)

plot(carb$pH ~ carb$OmegaCalcite)

sw$Om_a = carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$OmegaAragonite
sw$Om_c= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$OmegaCalcite
sw$DIC= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$DIC
sw$PCO2= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$PCO2

```
calculating median values for sw treatments to apply to the plates (pH, TA, and S); mass.full saved as df
```{r}

sw.control = subset(sw,
            `Bucket#` == 7|
            `Bucket#`== 14)
plot(sw.control$ph.spec ~ sw.control$Date, col = as.factor(sw.control$fresh_old), pch = 19)
  points(ph.spec ~ Date, col = as.factor(fresh_old), data = sw.control[sw.control$`Bucket#` == 7,], pch = 19, cex = 1.5)
    points(ph.spec ~ Date, col = as.factor(fresh_old), data = sw.control[sw.control$`Bucket#` == 14,], pch = 19, cex = 1.5)

sw2 = subset(sw, 
            `Bucket#` != 7 &
            `Bucket#`!= 14)

sw = sw2

##########Total alkalinity

# Initialize an empty dataframe to store the results
final_result.TA <- data.frame(Bin = 1:14, med.TA = numeric(14))
# Iterate over each Bin#
for (bin in 1:14) {
  # Subset data for the current Bin#
  subset_data <- sw[sw$`Bucket#` == bin, ]
  
  # Calculate the median TA for the current Bin#
  median_TA <- median(subset_data$TA)
  
  # Assign the median value to the corresponding row in the final result dataframe
  final_result.TA[final_result.TA$Bin == bin, "med.TA"] <- median_TA
}

# Print the final_result dataframe
print(final_result.TA)

##########pH

# Iterate over each Bin#
for (bin in 1:14) {
  # Subset data for the current Bin#
  subset_data <- sw[sw$`Bucket#` == bin, ]
  
  # Calculate the median TA for the current Bin#
  median_pH <- median(subset_data$ph.spec)
  
  # Assign the median value to the corresponding row in the final result dataframe
  final_result.TA[final_result.TA$Bin == bin, "med.pH"] <- median_pH
}

# Print the final_result dataframe
print(final_result.TA)

##########Temperature

# Iterate over each Bin#
for (bin in 1:14) {
  # Subset data for the current Bin#
  subset_data <- sw[sw$`Bucket#` == bin, ]
  
  # Calculate the median temperature for the current Bin#
  median_T <- median(subset_data$T_c)
  
  # Assign the median value to the corresponding row in the final result dataframe
  final_result.TA[final_result.TA$Bin == bin, "med.T"] <- median_T
}

# Print the final_result dataframe
print(final_result.TA)

##########Salinity

# Iterate over each Bin#
for (bin in 1:14) {
  # Subset data for the current Bin#
  subset_data <- sw[sw$`Bucket#` == bin, ]
  
  # Calculate the median temperature for the current Bin#
  median_S <- median(subset_data$S)
  
    # Assign the median value to the corresponding row in the final result dataframe
  final_result.TA[final_result.TA$Bin == bin, "med.S"] <- median_S
}

# Print the final_result dataframe
print(final_result.TA)

##########Omega Calcite

# Iterate over each Bin#
for (bin in 1:14) {
  # Subset data for the current Bin#
  subset_data <- sw[sw$`Bucket#` == bin, ]
  
  # Calculate the median temperature for the current Bin#
  median_OmC <- median(subset_data$Om_c)
  
    # Assign the median value to the corresponding row in the final result dataframe
  final_result.TA[final_result.TA$Bin == bin, "med.OmC"] <- median_OmC
}

# Print the final_result dataframe
print(final_result.TA)

######Merging them all together: 
sw.med = final_result.TA 

#adding a column to gro TA with the median values

# Initialize empty columns for median values in the 'mass' dataframe
mass$med.ta <- NA
mass$med.pH <- NA
mass$med.S <- NA
mass$med.T <- NA
mass$med.OmC <- NA

sw.med = subset(sw.med,
                Bin != 7 &
                Bin != 14)

# Loop through bins 1 to 14
for (bin in 1:14) {
  # Filter 'sw.med' for the current bin and get the median TA
  median_ta <- sw.med[sw.med$Bin == bin, "med.TA"]
  median_pH <- sw.med[sw.med$Bin == bin, "med.pH"]
  median_T <- sw.med[sw.med$Bin == bin, "med.T"]
  median_S <- sw.med[sw.med$Bin == bin, "med.S"]
  median_OmC <- sw.med[sw.med$Bin == bin, "med.OmC"]
  # Assign the median TA to the corresponding 'mass' rows based on Bucket#
  mass$med.ta[mass$`Bucket#` == bin] <- median_ta
  mass$med.pH[mass$`Bucket#` == bin] <- median_pH
  mass$med.T[mass$`Bucket#` == bin] <- median_T
  mass$med.S[mass$`Bucket#` == bin] <- median_S
  mass$med.OmC[mass$`Bucket#` == bin] <- median_OmC
}

mass.full = mass #saving as a full df in case I need to reference after subsetting

```
omitting control points from mass data; omitting CV_ID that fell off/died during trial; saved as mass and sa.proc
```{r}
#omitting controls
mass = mass[mass$med.S > 0 & mass$med.ta > 0,]

sa.proc = sa[sa$dps == 0 | sa$dps == 18 | sa$dps == 36,]

```
calculating growth rate from time step to time step; new df as growth_rate from sa.proc
```{r}
library(dplyr)

growth_rate = sa.proc %>%
  # first sort by year
  group_by(CV_ID) %>%
  mutate(Diff_time = date.numb - lag(date.numb),  # Difference in time (just in case there are gaps)
         Diff_growth = SA.mm2.RE - lag(SA.mm2.RE),
         Net_growth.d = ((SA.mm2.RE - SA.start)/(dps)),
         incr_growth.d = (Diff_growth/Diff_time),
         Net_growth.w = Net_growth.d * 7,
         incr_growth.w = (Diff_growth/Diff_time)*7,
         Net_growth = (SA.mm2.RE - SA.start)
         )

```
merging the growth + treatments + mass into one data frame; new df to use from here = dat
```{r}
full = merge(growth_rate, mass, by = "CV_ID")
dat = subset(full, 
             SA.start < 245 &
             Diff_growth > -20 &
               Diff_growth < 50 &
               Net_growth > -50 &
             `%oc.ic.shell` > 0 &
               CV_ID != 526&
               CV_ID != 536&
               CV_ID != 538 &
              shell.wt < 850)
dat.ids = unique(dat[dat$dps == 36,]$CV_ID)

common_ids <- dat.ids[dat.ids %in% dat.ids]

# Subset dat dataframe based on CV_ID being in dat.ids
subset_dat <- dat[dat$CV_ID %in% common_ids, ]

unique(subset_dat$CV_ID)


#full$SA.start < 250 &
dat$TA.treat.x = as.factor(dat$TA.treat.x)

write.csv(subset_dat, file = "dat.processed.csv", row.names = F) #WILL USE THIS DF FOR MODELING IN OTHER R MARKDOWN FILE
#write.csv(subset_dat, file = "dat.processed2.csv", row.names = F) #WILL USE THIS DF FOR MODELING IN OTHER R MARKDOWN FILE

```
control
```{r}

dat = subset_dat

plot(control$shell.wt ~ control$SA.mm2, pch = 19, col = as.factor(control$Plate))

plot(control$shell.wt ~ control$gut.wt, pch = 19, col = as.factor(control$Plate))

control$CI = control$gut.wt/control$shell.wt
boxplot(control$CI ~ control$Plate) #CI went down in controls; potentially indicating that oysters were in a phase of producing less shell, using tissue reserves (dormancy?) and that food + our temp was not warm enough to wake them up fully.

ave.pre.gut = mean(control[control$Plate == "pre",]$gut.wt)

ave.post.gut = mean(control[control$Plate == "post",]$gut.wt)

ave.pre.ci = mean(control[control$Plate == "pre",]$CI)

ave.post.ci = mean(control[control$Plate == "post",]$CI)

ave.pre.sa.mm2 = mean(control[control$Plate == "pre",]$SA.mm2)

ave.post.sa.mm2 = mean(control[control$Plate == "post",]$SA.mm2)

boxplot(SA.mm2 ~ sal.treat.x + TA.treat.x, dat = dat[dat$dps == 36,])
abline(h = c(ave.pre.sa.mm2), lwd = 2, lty = 2)

boxplot(CI ~ sal.treat.x + TA.treat.x, dat = dat[dat$dps == 36,], ylim = c(0.005,0.029))
abline(h = c(ave.pre.ci), lwd = 2, lty = 2)

boxplot(gut.wt ~ sal.treat.x + TA.treat.x, dat = dat[dat$dps == 36,])
abline(h = c(ave.pre.ci), lwd = 2, lty = 2)


```

survival, tissue wt, shell growth per day
```{r}

dat$ave.tiss = NA
dat[dat$T. == "T1",]$ave.tiss <- mort[mort$T. == "T1",]$ave.tiss
dat[dat$T. == "T2",]$ave.tiss <- mort[mort$T. == "T2",]$ave.tiss
dat[dat$T. == "T3",]$ave.tiss <- mort[mort$T. == "T3",]$ave.tiss
dat[dat$T. == "t1",]$ave.tiss <- mort[mort$T. == "t1",]$ave.tiss
dat[dat$T. == "t2",]$ave.tiss <- mort[mort$T. == "t2",]$ave.tiss
dat[dat$T. == "t3",]$ave.tiss <- mort[mort$T. == "t3",]$ave.tiss

#adding in omega column
dat$med.omC = carb(flag = 8, var1 = dat$med.pH, var2 = dat$med.ta/10^6, T = dat$med.T, S = dat$med.S)$OmegaCalcite

dat$med.omA = carb(flag = 8, var1 = dat$med.pH, var2 = dat$med.ta/10^6, T = dat$med.T, S = dat$med.S)$OmegaAragonite

plot(dat$mort ~ dat$med.ta)
plot(dat$mort ~ dat$med.S)
plot(dat$mort ~ dat$med.omC)
plot(dat$mort ~ dat$med.omA)
plot(dat$med.ta ~ dat$med.omC)
boxplot(dat$mort ~ dat$TA.treat.x + dat$sal.treat.x)

#dry tissue weight at the end
boxplot(dat$ave.tiss ~ dat$T.)
abline(h=c(ave.post.gut, ave.post.gut))

plot(gut.wt ~ med.ta, pch = 19, data = dat[dat$dps == 36,])
plot((dat$gut.wt - ave.post.gut) ~ dat$med.ta, pch = 19)
plot((dat$gut.wt - ave.post.gut) ~ dat$med.S, pch = 19)



summary(lm((CI - ave.pre.ci) ~ factor(T.), data = dat[dat$dps == 36,]))
#now run a post hoc to see if CI is lower? 
lm_model =  lm((CI - ave.pre.ci) ~ factor(T.), data = dat[dat$dps == 36, ])
# Conduct pairwise comparisons of factor levels using Tukey's method
# Load the emmeans package
install.packages("emmeans")
library(emmeans)

# Conduct pairwise comparisons of factor levels using Tukey's method
posthoc <- emmeans(lm_model, ~ factor(T.), adjust = "tukey")

# Summarize the comparisons
summary(posthoc)
plot(posthoc) #this shows that the two high S high TA treatments had CI similar to the pre Ci whereas the rest of the treatments had reduced CI relative to control.




```



EXTRA CODE BELOW 
```{r}

#sa.proc = subset(sa, sa$CV_ID != 581 &
                   sa$CV_ID != 578 & 
                   sa$CV_ID != 577 & 
                   sa$CV_ID != 571 &             
                   sa$CV_ID != 570 &
                   sa$CV_ID != 567 & 
                   sa$CV_ID != 566 & 
                   sa$CV_ID != 564 & 
                   sa$CV_ID != 561 & 
                   sa$CV_ID != 549 & 
                   sa$CV_ID != 544 & 
                   sa$CV_ID != 541 &
                   sa$CV_ID != 537 &
                    sa$CV_ID != 526 &
                    sa$CV_ID != 536 &
                   sa$CV_ID != 534 &
                    sa$CV_ID != 538 &
                   sa$CV_ID != 530 & 
                   sa$CV_ID != 517 & 
                   sa$CV_ID != 514 & 
                   sa$CV_ID != 491 & 
                   sa$CV_ID != 482 &
                   sa$CV_ID != 479 & 
                   sa$CV_ID != 472 & 
                   sa$CV_ID != 470 & 
                   sa$CV_ID != 465 & 
                   sa$CV_ID != 464 &
                   sa$CV_ID != 462 & 
                   sa$CV_ID != 459 &
                   sa$CV_ID != 442 & 
                   sa$CV_ID != 437 & 
                   sa$CV_ID != 419 & 
                   sa$CV_ID != 409 & 
                   sa$CV_ID != 405 & 
                   sa$CV_ID != 403 &
                   sa$CV_ID != 367 & 
                   sa$CV_ID != 360 & 
                   sa$CV_ID != 348 &
                   sa$CV_ID != 337 &
                   sa$CV_ID != 334 &
                   sa$CV_ID != 332 & 
                   sa$CV_ID != 329 & 
                   sa$CV_ID != 326 &
                   sa$CV_ID != 321 &
                   sa$CV_ID != 317 & 
                   sa$CV_ID != 313 & 
                   sa$CV_ID != 311 & 
                   sa$CV_ID != 306 &
                   sa$CV_ID != 305 & 
                   sa$CV_ID != 301 & 
                   sa$CV_ID != 300 & 
                   sa$CV_ID != 299 &
                   sa$CV_ID != 298 &
                   sa$CV_ID != 297 & 
                   sa$CV_ID != 296 &
                   sa$CV_ID != 271 & 
                   sa$CV_ID != 241 & 
                   sa$CV_ID != 223 & 
                   sa$CV_ID != 218 & 
                   sa$CV_ID != 205 &
                   sa$CV_ID != 203 &
                   sa$CV_ID != 192 & 
                   sa$CV_ID != 161& 
                   sa$CV_ID != 150 & 
                   sa$CV_ID != 149 & 
                   sa$CV_ID != 146 &
                   sa$CV_ID != 131 & 
                   sa$CV_ID != 114 &
                   sa$CV_ID != 91 & 
                   sa$CV_ID != 78 & 
                   sa$CV_ID != 54 & 
                   sa$CV_ID != 42 &
                   sa$CV_ID != 29 & 
                   sa$CV_ID != 13 &
                   sa$CV_ID != 7 & 
                   sa$CV_ID != 6)

#omitting CV ids that DIED off during trial
sa.proc = subset(sa,sa$CV_ID != 577 & 
                   sa$CV_ID != 571 &             
                   sa$CV_ID != 570 &
                   sa$CV_ID != 564 & 
                   sa$CV_ID != 561 & 
                   sa$CV_ID != 544 & 
                   sa$CV_ID != 537 & 
                   sa$CV_ID != 530 & 
                   sa$CV_ID != 514 & 
                   sa$CV_ID != 479 & 
                   sa$CV_ID != 462 & 
                   sa$CV_ID != 459 &
                   sa$CV_ID != 409 & 
                   sa$CV_ID != 405 & 
                   sa$CV_ID != 403 &
                   sa$CV_ID != 348 &
                   sa$CV_ID != 337 &
                   sa$CV_ID != 334 &
                   sa$CV_ID != 332 & 
                   sa$CV_ID != 321 &
                   sa$CV_ID != 317 & 
                   sa$CV_ID != 313 & 
                   sa$CV_ID != 311 & 
                   sa$CV_ID != 305 & 
                   sa$CV_ID != 299 &
                   sa$CV_ID != 298 &
                   sa$CV_ID != 271 & 
                   sa$CV_ID != 241 & 
                   sa$CV_ID != 218 & 
                   sa$CV_ID != 205 &
                   sa$CV_ID != 192 & 
                   sa$CV_ID != 146 &
                   sa$CV_ID != 91 & 
                   sa$CV_ID != 78 & 
                   sa$CV_ID != 42 &
                   sa$CV_ID != 29 & 
                   sa$CV_ID != 7 & 
                   sa$CV_ID != 6)

```
################################################
looking into what drives the variability?
```{r}
plot(amb.S$med.ta ~ amb.S$med.pH)

```
look at the dat data and correcting for outliers? 
```{r}
plot(dat$Net_growth ~ dat$SA.start, pch = 19, col = as.factor(dat$TA.treat.x))
summary(dat[dat$dps != 0,]$Net_growth)
q1 = 1.092           
q3 = 15.403        
iqr = q3-q1
max = q3 + (1.5*iqr)
min = q1 - (1.5*iqr)
plot(dat$Net_growth, pch = 19)
abline(h=c(min,max))

```
what is the effect of S on growth?
```{r}
#creating a df with just amb TA and just low TA
amb = dat[dat$med.ta>1800 & dat$med.ta<2300,]
low = dat[dat$med.ta < 1000,]

#at ambient TA, low S individuals had higher overall growth
end = amb[amb$dps == 36,]
mod = aov(Net_growth ~ factor(med.S), data=end, na.action=na.omit)#using med.S so that I can not have bucket at a grouping variable?
summary(mod)


boxplot(amb[amb$dps == 36,]$Net_growth ~ amb[amb$dps == 36,]$TA.treat.x, pch = 19, ylab = NA, xlab = NA, names= NA, ylim = c(-20,60), frame.plot = F, xlim = c(0,4), axes = F, col = "grey40")
lines(x= c(1,4), y=c(-20,-20), lwd = 2)
lines(x= c(1,1), y=c(-20,60), lwd = 2)
axis(side = 1, line = -1, tick = F, at = c(2,3), labels = c("Ambient","Reduced"), cex.axis = 1.25)
axis(side = 1, line = .5, tick = F, at = 2.5, labels = "Salinity Level", cex.axis = 1.25)
axis(side = 2, line = -7.5, tick = F, at = c(-20,-10,0,10,20,30,40,50,60), labels = c("-20","-10","0","10","20","30","40","50","60"), cex.axis = 1.25, las = 1)
axis(side = 2, line = -5.75, tick = F, at = 20, labels = expression(paste('Net surface area growth (mm'^2,')')), cex.axis = 1.25)

boxplot(amb[amb$dps == 15,]$Net_growth ~ amb[amb$dps == 15,]$TA.treat.x, pch = 19, ylab = NA, xlab = NA, names= NA, ylim = c(-20,70), frame.plot = F, xlim = c(0,4), axes = F, col = "grey")
lines(x= c(1,4), y=c(-20,-20), lwd = 2)
lines(x= c(1,1), y=c(-20,60), lwd = 2)
axis(side = 1, line = -1, tick = F, at = c(2,3), labels = c("Ambient","Reduced"), cex.axis = 1.25)
axis(side = 1, line = .5, tick = F, at = 2.5, labels = "Salinity Level", cex.axis = 1.25)
axis(side = 2, line = -7.5, tick = F, at = c(-20,-10,0,10,20,30,40,50,60), labels = c("-20","-10","0","10","20","30","40","50","60"), cex.axis = 1.25, las = 1)
axis(side = 2, line = -5.75, tick = F, at = 20, labels = expression(paste('Net surface area growth (mm'^2,')')), cex.axis = 1.25)

```

looking at growth ratios across time periods
```{r}
n=10
rbPal = colorRampPalette(c("gold1", "purple4"))
col.inc.grow =rbPal(10)[as.numeric(cut(dat$incr_growth, breaks = 10))]
col.ta = rbPal(4)[as.numeric(cut(dat$med.ta, breaks = 4))]

da1 = dat[dat$sal.treat.x == "amb",]
#week 1 - 2; effect of SA and TA; Positive effect of SA and increased growth increments in higher TA levels
plot(da1[da1$dps == 15,]$incr_growth ~ log(da1[da1$dps == 15,]$SA.mm2), pch = 19, col = rbPal(4)[as.numeric(cut(da1[da1$dps == 15,]$med.ta, breaks = 4))])
         summary(lm(da1[da1$dps == 12,]$incr_growth ~ log(da1[da1$dps == 12,]$SA.mm2) + da1[da1$dps == 12,]$med.ta))

#week 2 - 3; effect of SA and TA; but now increases in TA result in lower growth increments across size; SA still with a positive relationship
    plot(da1[da1$dps == 18,]$incr_growth ~ log(da1[da1$dps == 18,]$SA.mm2), pch = 19, col = rbPal(4)[as.numeric(cut(da1[da1$dps == 18,]$med.ta, breaks = 4))])
summary(lm(da1[da1$dps == 18,]$incr_growth ~ log(da1[da1$dps == 18,]$SA.mm2) + da1[da1$dps == 18,]$med.ta))

#week 4 - 5; no effect of any of size, TA 
    plot(da1[da1$dps == 36,]$incr_growth ~ log(da1[da1$dps == 36,]$SA.mm2), pch = 19, col = as.factor(da1[da1$dps == 36,]$TA.treat.x))
         summary(lm(da1[da1$dps == 36,]$incr_growth ~ log(da1[da1$dps == 36,]$SA.mm2) + da1[da1$dps == 36,]$med.ta))
         
         #find the week that the effect disappears
#week 3 - 4; very small positive effect of TA and large effect of SA
plot(da1[da1$dps == 25,]$incr_growth ~ log(da1[da1$dps == 25,]$SA.mm2), pch = 19, col = as.factor(da1[da1$dps == 25,]$TA.treat.x))
summary(lm(da1[da1$dps == 25,]$incr_growth ~ log(da1[da1$dps == 25,]$SA.mm2) + da1[da1$dps == 25,]$med.ta))


da2 = dat[dat$sal.treat.x == "low",]

#week 1 - 2; effect of SA and TA; both positive; SA much larger effect than TA; similar effect sizes to what is seen in the ambient salinity (intercept values)
plot(da2[da2$dps == 12,]$incr_growth ~ log(da2[da2$dps == 12,]$SA.mm2), pch = 19, col = as.factor(da2[da2$dps == 12,]$TA.treat.x))
summary(lm(da2[da2$dps == 12,]$incr_growth ~ log(da2[da2$dps == 12,]$SA.mm2) + da2[da2$dps == 12,]$med.ta))

#week 2 - 3; effect of SA and TA; but now increases in TA result in lower growth increments across size; SA still with a positive relationship; size much stronger effect in the ambient; TA has similar magnitude shift in intercept than ambient
    plot(da2[da2$dps == 18,]$incr_growth ~ log(da2[da2$dps == 18,]$SA.mm2), pch = 19, col = as.factor(da2[da2$dps == 18,]$TA.treat.x))
summary(lm(da2[da2$dps == 18,]$incr_growth ~ log(da2[da2$dps == 18,]$SA.mm2) + da2[da2$dps == 18,]$med.ta))

#week 4 - 5; no effect of any of size, TA
    plot(da2[da2$dps == 36,]$incr_growth ~ log(da2[da2$dps == 36,]$SA.mm2), pch = 19, col = as.factor(da2[da2$dps == 36,]$TA.treat.x))
         summary(lm(da2[da2$dps == 36,]$incr_growth ~ log(da2[da2$dps == 36,]$SA.mm2) + da2[da2$dps == 36,]$med.ta))
         
         #find the week that the effect disappears
#week 3 - 4; as the TA increases, the intercept for incremental growth goes down and there is no relationship with size. AKA pattern not here either.
    plot(da2[da2$dps == 25,]$incr_growth ~ log(da2[da2$dps == 25,]$SA.mm2), pch = 19, col = as.factor(da2[da2$dps == 25,]$TA.treat.x))
    summary(lm(da2[da2$dps == 25,]$incr_growth ~ log(da2[da2$dps == 25,]$SA.mm2) + da2[da2$dps == 25,]$med.ta))


```


exceedence plots
```{r}
write.csv(dat, file = "to create ranking3.csv", row.names = T)

#for each day on each plate, I need R to go through and rank the individual by incremental growth (new col 1) and then divide that number by 1+nrow(plate) (new col 2) and then rank the individual by net growth (new col 3) and then divide that number by 1+nrow(plate) (new col 4)


#exc = read.csv("w.prob.est.1539.csv") #each ranking is based on a narrow binning of TA (w/in 50umol)
exc = read.csv("w.prob.csv") #each ranking is based on a plate (a given set of conditions)

rbPal = colorRampPalette(c("gold1", "purple4"))
exc$ta.col = rbPal(8)[as.numeric(cut(exc$med.ta, breaks = 8))]

#size probability plots
unique(exc$dps) # 0 15 36 
#starting week
plot(exc$prob.size ~ exc$SA.mm2, type = "n")
points(exc[exc$dps == 0 & exc$sal.treat.x == "amb",]$prob.size ~ exc[exc$dps == 0& exc$sal.treat.x == "amb",]$SA.mm2, pch = 21, bg = exc$ta.col, xlab = "Surface area (mm2)", ylab = "Probability Estimate") #all of the lines overlapping; that's good. shows that all individuals starting at same size curves
plot(exc$prob.size ~ exc$SA.mm2, type = "n")
points(exc[exc$dps == 0 & exc$sal.treat.x == "low",]$prob.size ~ exc[exc$dps == 0& exc$sal.treat.x == "low",]$SA.mm2, pch = 21, bg = exc$ta.col, xlab = "Surface area (mm2)", ylab = "Probability Estimate") #all of the lines overlapping; that's good. shows that all individuals starting at same size curves

#week 2
plot(exc$prob.size ~ exc$SA.mm2, type = "n")
points(exc[exc$dps == 15 & exc$sal.treat.x == "amb",]$prob.size ~ exc[exc$dps == 15 & exc$sal.treat.x == "amb",]$SA.mm2, pch = 21, bg = exc$ta.col, xlab = "Surface area (mm2)", ylab = "Probability Estimate") #
plot(exc$prob.size ~ exc$SA.mm2, type = "n")
points(exc[exc$dps == 15 & exc$sal.treat.x == "low",]$prob.size ~ exc[exc$dps == 15 & exc$sal.treat.x == "low",]$SA.mm2, pch = 21, bg = exc$ta.col, xlab = "Surface area (mm2)", ylab = "Probability Estimate") #

#week 5
plot(exc$prob.size ~ exc$SA.mm2, type = "n")
points(exc[exc$dps == 36 & exc$sal.treat.x == "amb",]$prob.size ~ exc[exc$dps == 36 & exc$sal.treat.x == "amb",]$SA.mm2, pch = 21, bg = exc$ta.col, xlab = "Surface area (mm2)", ylab = "Probability Estimate") #
points(exc[exc$dps == 36 & exc$sal.treat.x == "low",]$prob.size ~ exc[exc$dps == 36 & exc$sal.treat.x == "low",]$SA.mm2, pch = 21, bg = exc$ta.col, xlab = "Surface area (mm2)", ylab = "Probability Estimate") #


#looking at growth rates (incremental between week 2 and week 5)
#week 2
plot(exc$prob.growth.inc ~ exc$incr_growth, type = "n")
points(exc[exc$dps == 15 & exc$sal.treat.x == "amb",]$prob.growth.inc ~ exc[exc$dps == 15 & exc$sal.treat.x == "amb",]$incr_growth, pch = 21, bg = exc$ta.col, xlab = "Incremental growth (mm2/day between day 0 and day 12)", ylab = "Probability Estimate") #at week two, the incremental growth is not impacted by TA
plot(exc$prob.growth.inc ~ exc$incr_growth, type = "n")
points(exc[exc$dps == 15 & exc$sal.treat.x == "low",]$prob.growth.inc ~ exc[exc$dps == 15 & exc$sal.treat.x == "low",]$incr_growth, pch = 21, bg = exc$ta.col, xlab = "Incremental growth (mm2/day between day 0 and day 12)", ylab = "Probability Estimate") #at week two, it looks like the high TA has the highest incremental growth

#week 5
plot(exc$prob.growth.inc ~ exc$incr_growth, type = "n")
points(exc[exc$dps == 36 & exc$sal.treat.x == "amb",]$prob.growth.inc ~ exc[exc$dps == 36 & exc$sal.treat.x == "amb",]$incr_growth, pch = 21, bg = exc$ta.col, xlab = "Incremental growth (mm2/day between day 12 and day 36)", ylab = "Probability Estimate") #at week five, high TA has the highest incremental growth
plot(exc$prob.growth.inc ~ exc$incr_growth, type = "n")
points(exc[exc$dps == 36 & exc$sal.treat.x == "low",]$prob.growth.inc ~ exc[exc$dps == 36 & exc$sal.treat.x == "low",]$incr_growth, pch = 21, bg = exc$ta.col, xlab = "Incremental growth (mm2/day between day 12 and day 36)", ylab = "Probability Estimate") #at week two, it looks like the high TA has the highest incremental growth


#looking at growth rates (net growth between 0 - week 2 and 0 - week 5)
#week 2
plot(exc$prob.growth.net ~ exc$Net_growth, type = "n")
points(exc[exc$dps == 15 & exc$sal.treat.x == "amb",]$prob.growth.net ~ exc[exc$dps == 15 & exc$sal.treat.x == "amb",]$Net_growth, pch = 21, bg = exc$ta.col, xlab = "Net growth (mm2/day between day 0 and day 12)", ylab = "Probability Estimate") #at week two, the net growth is not impacted by TA
plot(exc$prob.growth.net ~ exc$Net_growth, type = "n")
points(exc[exc$dps == 15 & exc$sal.treat.x == "low",]$prob.growth.net ~ exc[exc$dps == 15 & exc$sal.treat.x == "low",]$Net_growth, pch = 21, bg = exc$ta.col, xlab = "Net growth (mm2/day between day 0 and day 12)", ylab = "Probability Estimate") #at week two, it looks like the high TA has the highest net growth

#week 5
plot(exc$prob.growth.net ~ exc$Net_growth, type = "n")
points(exc[exc$dps == 36 & exc$sal.treat.x == "amb",]$prob.growth.net ~ exc[exc$dps == 36 & exc$sal.treat.x == "amb",]$Net_growth, pch = 21, bg = exc$ta.col, xlab = "Net growth (mm2/day between day 12 and day 36)", ylab = "Probability Estimate") #at week five, high TA has the highest incremental growth
plot(exc$prob.growth.net ~ exc$Net_growth, type = "n")
points(exc[exc$dps == 36 & exc$sal.treat.x == "low",]$prob.growth.net ~ exc[exc$dps == 36 & exc$sal.treat.x == "low",]$Net_growth, pch = 21, bg = exc$ta.col, xlab = "Net growth (mm2/day between day 12 and day 36)", ylab = "Probability Estimate") #at week two, it looks like the high TA has the highest incremental growth
```

```{r}
end = dat[dat$dps == 36,]
end$TA.treat.x = as.factor(end$TA.treat.x)
end$og.sa = end$orgC.shell.wt/end$SA.mm2
end.h = end[end$sal.treat.x == "amb" & end$og.sa < 0.15,]
end.l = end[end$sal.treat.x == "low"& end$og.sa < 0.15,]

dps.15 = dat[dat$dps == 15,]
plot(dps.15$incr_growth ~ dps.15$med.ta, col = as.factor(dps.15$sal.treat.x))
boxplot(dps.15[dps.15$sal.treat.x == "amb",]$incr_growth ~ dps.15[dps.15$sal.treat.x == "amb",]$TA.treat.x)
boxplot(dps.15[dps.15$sal.treat.x == "low",]$incr_growth ~ dps.15[dps.15$sal.treat.x == "low",]$TA.treat.x)
                                                


#relationship between SA and gut wt; not mod by TA
#relationship between SA and % organic matter; not mod by TA
#relationship between gut and % organic matter; not mod by TA

#TA diff in org matter on shell?
plot(end.h$og.sa ~ jitter(end.h$med.ta,10), pch = 19, ylim = c(0,0.1), xlab = "TA treatment", ylab = "Organic material on shell (mass/SA)")
summary(lm(end.h$og.sa ~ end.h$med.ta)) #INCREASED ORG WITH INCREASED TA
abline(2.868e-02,(3.082e-06), lwd = 3)

plot(end.l$og.sa ~ jitter(end.l$med.ta,50), ylim = c(0,0.1), xlab = "TA treatment", ylab = "Organic material on shell (mass/SA)", pch = 19)
summary(lm(end.l$og.sa ~ end.l$med.ta)) #NO RELATIONSHIP

#TA diff in gut mass?
plot(end.h$gut.wt ~ end.h$med.ta)
summary(lm(end.h$gut.wt ~ end.h$med.ta)) #NO RELATIONSHIP
plot(end.l$gut.wt ~ end.l$med.ta)
summary(lm(end.l$gut.wt ~ end.l$med.ta)) #NO RELATIONSHIP

#TA diff in net growth
boxplot(end.h$Net_growth ~ end.h$TA.treat.x, pch = 19)
plot(end.h$Net_growth ~ jitter(end.h$med.ta,10), pch = 19)
summary(aov(end.h$Net_growth ~ end.h$TA.treat.x))
TukeyHSD(aov(end.h$Net_growth ~ end.h$TA.treat.x),"end.h$TA.treat.x")

boxplot(end.l$Net_growth ~ end.l$TA.treat.x, pch = 19)
plot(end.l$Net_growth ~ jitter(end.l$med.ta,10), pch = 19)
summary(aov(end.l$Net_growth ~ end.l$TA.treat.x))
TukeyHSD(aov(end.l$Net_growth ~ end.l$TA.treat.x),"end.l$TA.treat.x")

#TA diff in inc growth
boxplot(end.h$incr_growth ~ end.h$TA.treat.x, pch = 19)
plot(end.h$incr_growth ~ jitter(end.h$med.ta,10), pch = 19)
summary(aov(end.h$incr_growth ~ end.h$TA.treat.x))
TukeyHSD(aov(end.h$incr_growth ~ end.h$TA.treat.x),"end.h$TA.treat.x")

boxplot(end.l$incr_growth ~ end.l$TA.treat.x, pch = 19)
plot(end.l$incr_growth ~ jitter(end.l$med.ta,10), pch = 19)
summary(aov(end.l$incr_growth ~ end.l$TA.treat.x))
TukeyHSD(aov(end.l$incr_growth ~ end.l$TA.treat.x),"end.l$TA.treat.x")

#week 0-2
boxplot(exc[exc$sal.treat.x == "amb" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "amb"& exc$dps == 15,]$TA.treat.x, pch = 19)
plot(exc[exc$sal.treat.x == "amb" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "amb"& exc$dps == 15,]$med.ta, pch = 19)
summary(lm(exc[exc$sal.treat.x == "amb" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "amb"& exc$dps == 15,]$med.ta)) #no relationship
summary(aov(exc[exc$sal.treat.x == "amb" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "amb"& exc$dps == 15,]$TA.treat.x))

boxplot(exc[exc$sal.treat.x == "low" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "low"& exc$dps == 15,]$TA.treat.x, pch = 19)
summary(aov(exc[exc$sal.treat.x == "low" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "low"& exc$dps == 15,]$TA.treat.x))
plot(exc[exc$sal.treat.x == "low" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "low"& exc$dps == 15,]$med.ta, pch = 19)
summary(lm(exc[exc$sal.treat.x == "low" & exc$dps == 15,]$incr_growth ~ exc[exc$sal.treat.x == "low"& exc$dps == 15,]$med.ta)) #positive relationship

exc.modTA = exc[exc$med.ta > 1500 & exc$med.ta < 2500,]
end.modTA = end[end$med.ta > 1500 & end$med.ta < 2500,]
boxplot(end.modTA$Net_growth ~ end.modTA$sal.treat.x)
boxplot(end.modTA$incr_growth ~ end.modTA$sal.treat.x)
boxplot(exc.modTA[exc.modTA$dps == 15,]$Net_growth ~ exc.modTA[exc.modTA$dps == 15,]$sal.treat.x)

```





```{r}


plot(exc$prob.ig ~ exc$incr_growth, pch = 21, bg = col.ta, type = "n")
  points(exc[exc$sal.treat.x == "amb" & exc$dps == 39,]$prob.ig ~ exc[exc$sal.treat.x == "amb" &  exc$dps == 39 ,]$incr_growth,  bg = exc[exc$sal.treat.x == "amb" &  exc$dps == 39 ,]$ta.col, pch = 21)
    points(exc[exc$sal.treat.x == "low" & exc$dps == 39,]$prob.ig ~ exc[exc$sal.treat.x == "low" &  exc$dps == 39 ,]$incr_growth,  bg = exc[exc$sal.treat.x == "amb" &  exc$dps == 39 ,]$ta.col, pch = 21)
    
    
    
plot(exc$prob.est.ig ~ exc$incr_growth, pch = 21)
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 1000 & exc$dps == 15,]$prob.est.ig ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 1000 & 
  exc$dps == 15,]$incr_growth,
  bg = "blue", pch = 21)
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 1000 & exc$dps == 39,]$prob.est.ig ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 1000 & 
  exc$dps == 39,]$incr_growth,
  bg = "blue4", pch = 21)
  
    points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 2000 & exc$dps == 15,]$prob.est.ig ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 2000 & 
  exc$dps == 15,]$incr_growth,
  bg = "yellow", pch = 21)
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 2000 & exc$dps == 39,]$prob.est.ig ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 2000 & 
  exc$dps == 39,]$incr_growth,
  bg = "yellow4", pch = 21)
  
    points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 3000 & exc$dps == 15,]$prob.est.ig ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 3000 & 
  exc$dps == 15,]$incr_growth,
  bg = "purple", pch = 21)
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 3000 & exc$dps == 39,]$prob.est.ig ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 3000 & 
  exc$dps == 39,]$incr_growth,
  bg = "purple4", pch = 21)
  
  
#to compare each of the curves
  # high TA, amb S has the curve most shifted to the right; indicating that the incremental growth rates are higher overall than in other TA treatments between week 1 and 2 of the trial
  # high TA, amb S also shows the largest shift to the left among the TA treatments; indicating that it showed the largest decline in incremental growth rate with time
  # mid TA, amb S has a consistent incremental growth rate over time, which makes sense because this treatment was the one closest to what they were experiencing in ambient conditions prior to the assay
  # low TA, amb S has a similar curve to high TA at day 36, however, the curve at day 12 seems to be the flattest, crossing all of the curves at this time point
  
plot(exc$prob.est.ig ~ exc$incr_growth, pch = 21, type = "n")
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 1000 & exc$dps == 12,]$prob.est.ig ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 1000 & 
  exc$dps == 12,]$incr_growth,
  bg = "blue", pch = 21)
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 1000 & exc$dps == 36,]$prob.est.ig ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 1000 & 
  exc$dps == 36,]$incr_growth,
  bg = "blue4", pch = 21)
  
    points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 2000 & exc$dps == 12,]$prob.est.ig ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 2000 & 
  exc$dps == 12,]$incr_growth,
  bg = "yellow", pch = 21)
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 2000 & exc$dps == 36,]$prob.est.ig ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 2000 & 
  exc$dps == 36,]$incr_growth,
  bg = "yellow4", pch = 21)
  
    points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 3000 & exc$dps == 12,]$prob.est.ig ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 3000 & 
  exc$dps == 12,]$incr_growth,
  bg = "purple", pch = 21)
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 3000 & exc$dps == 36,]$prob.est.ig ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 3000 & 
  exc$dps == 36,]$incr_growth,
  bg = "purple4", pch = 21)
  
n=10
rbPal = colorRampPalette(c("gold1", "purple4"))
col.ta =rbPal(10)[as.numeric(cut(exc$med.ta, breaks = 10))]
plot(exc$prob.est.ig ~ exc$incr_growth, pch = 21, type = "n")
points(exc[exc$sal.treat.x == "amb" & exc$dps == 12,]$prob.est.ig ~ exc[exc$sal.treat.x == "amb"& exc$dps == 12,]$incr_growth, bg = col.ta, pch = 21)

points(exc[exc$sal.treat.x == "low" & exc$dps == 12,]$prob.est.ig ~ exc[exc$sal.treat.x == "low"& exc$dps == 12,]$incr_growth, bg = col.ta, pch = 21)

points(exc[exc$sal.treat.x == "amb" & exc$dps == 36,]$prob.est.ig ~ exc[exc$sal.treat.x == "amb"& exc$dps == 36,]$incr_growth, bg = col.ta, pch = 22)

points(exc[exc$sal.treat.x == "low" & exc$dps == 36,]$prob.est.ig ~ exc[exc$sal.treat.x == "low"& exc$dps == 36,]$incr_growth, bg = col.ta, pch = 22)
  #--Voila!  You have your probability curves (probability that a given growth measurement is less than a particular value).

#now looking at the trends for net growth across treatments? 

plot(exc$prob.est.ng ~ exc$net.grow, pch = 21, type = "n")
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 1000 & exc$dps == 12,]$prob.est.ng ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 1000 & 
  exc$dps == 12,]$net.grow,
  bg = "blue", pch = 21)
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 1000 & exc$dps == 36,]$prob.est.ng ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 1000 & 
  exc$dps == 36,]$net.grow,
  bg = "blue4", pch = 21)
  
    points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 2000 & exc$dps == 12,]$prob.est.ng ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 2000 & 
  exc$dps == 12,]$net.grow,
  bg = "yellow", pch = 21)
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 2000 & exc$dps == 36,]$prob.est.ng ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 2000 & 
  exc$dps == 36,]$net.grow,
  bg = "yellow4", pch = 21)
  
    points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 3000 & exc$dps == 12,]$prob.est.ng ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 3000 & 
  exc$dps == 12,]$net.grow,
  bg = "purple", pch = 21)
  points(exc[exc$sal.treat.x == "amb" &
  exc$TA.treat.x == 3000 & exc$dps == 36,]$prob.est.ng ~
  exc[exc$sal.treat.x == "amb" & exc$TA.treat.x == 3000 & 
  exc$dps == 36,]$net.grow,
  bg = "purple4", pch = 21)
  
  
plot(exc$prob.est.ng ~ exc$net.grow, pch = 21, type = "n")
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 1000 & exc$dps == 12,]$prob.est.ng ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 1000 & 
  exc$dps == 12,]$net.grow,
  bg = "blue", pch = 21)
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 1000 & exc$dps == 36,]$prob.est.ng ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 1000 & 
  exc$dps == 36,]$net.grow,
  bg = "blue4", pch = 21)
  
    points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 2000 & exc$dps == 12,]$prob.est.ng ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 2000 & 
  exc$dps == 12,]$net.grow,
  bg = "yellow", pch = 21)
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 2000 & exc$dps == 36,]$prob.est.ng ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 2000 & 
  exc$dps == 36,]$net.grow,
  bg = "yellow4", pch = 21)
  
    points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 3000 & exc$dps == 12,]$prob.est.ng ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 3000 & 
  exc$dps == 12,]$net.grow,
  bg = "purple", pch = 21)
  points(exc[exc$sal.treat.x == "low" &
  exc$TA.treat.x == 3000 & exc$dps == 36,]$prob.est.ng ~
  exc[exc$sal.treat.x == "low" & exc$TA.treat.x == 3000 & 
  exc$dps == 36,]$net.grow,
  bg = "purple4", pch = 21)
  
n=10
rbPal = colorRampPalette(c("gold1", "purple4"))
col.ta =rbPal(10)[as.numeric(cut(exc$med.ta, breaks = 10))]
plot(exc$prob.est.ng ~ exc$net.grow, pch = 21, type = "n")
points(exc[exc$sal.treat.x == "amb" & exc$dps == 12,]$prob.est.ng ~ exc[exc$sal.treat.x == "amb"& exc$dps == 12,]$net.grow, bg = col.ta, pch = 21)

points(exc[exc$sal.treat.x == "low" & exc$dps == 12,]$prob.est.ng ~ exc[exc$sal.treat.x == "low"& exc$dps == 12,]$net.grow, bg = col.ta, pch = 21)

points(exc[exc$sal.treat.x == "amb" & exc$dps == 36,]$prob.est.ng ~ exc[exc$sal.treat.x == "amb"& exc$dps == 36,]$net.grow, bg = col.ta, pch = 21)

points(exc[exc$sal.treat.x == "low" & exc$dps == 36,]$prob.est.ng ~ exc[exc$sal.treat.x == "low"& exc$dps == 36,]$net.grow, bg = col.ta, pch = 21)
  #--Voila!  You have your probability curves (probability that a given growth measurement is less than a particular value).

plot(exc$prob.est.ig ~ exc$incr_growth, pch = 21, type = "n")

points(exc[exc$dps == 12,]$prob.est.ig ~ exc[exc$dps == 12,]$incr_growth, bg = col.ta, pch = 21)

points(exc[exc$sal.treat.x == "amb" & exc$dps == 12,]$prob.est.ig ~ exc[exc$sal.treat.x == "amb"& exc$dps == 12,]$incr_growth, bg = "black", pch = 22)

points(exc[exc$dps == 36,]$prob.est.ig ~ exc[exc$dps == 36,]$incr_growth, bg = col.ta, pch = 21)

points(exc[exc$sal.treat.x == "amb" & exc$dps == 36,]$prob.est.ig ~ exc[exc$sal.treat.x == "amb"& exc$dps == 36,]$incr_growth, bg = "black", pch = 22)


plot(ex$prob.est.ig ~ ex$incr_growth, pch = 21, type = "n")
points(ex[ex$dps == 12,]$prob.est.ig ~ ex[ex$dps == 12,]$incr_growth, pch = 21)

points(ex[ex$dps == 36,]$prob.est.ig ~ ex[ex$dps == 36,]$incr_growth, pch = 21)

points(ex[ex$dps == 15,]$prob.est.ig ~ ex[ex$dps == 15,]$incr_growth, pch = 21)

points(ex[ex$dps == 39,]$prob.est.ig ~ ex[ex$dps == 39,]$incr_growth, pch = 21)


#incremental growth jumps back and forth between net growth and net dissolution...this is interesting...
plot(exc$prob.est.ig ~ exc$incr_growth, pch = 21, type = "n")
points(exc[exc$dps == 7,]$prob.est.ig ~ exc[exc$dps == 7,]$incr_growth, pch = 21, bg = col.ta)

points(exc[exc$dps == 12,]$prob.est.ig ~ exc[exc$dps == 12,]$incr_growth, pch = 21, bg = col.ta)

points(exc[exc$dps == 15,]$prob.est.ig ~ exc[exc$dps == 15,]$incr_growth, pch = 21, bg = col.ta)

points(ex[ex$dps == 36,]$prob.est.ig ~ ex[ex$dps == 36,]$incr_growth, pch = 21, bg = col.ta)

points(ex[ex$dps == 39,]$prob.est.ig ~ ex[ex$dps == 39,]$incr_growth, pch = 21, bg = col.ta)

#now just looking at end of 7 days, 12 days, and 39 days of exposure in separate salinities
plot(exc[exc$sal.treat.x == "amb",]$prob.est.ig ~ exc[exc$sal.treat.x == "amb",]$incr_growth, pch = 21, type = "n")
points(exc[exc$dps == 7 & exc$sal.treat.x == "amb",]$prob.est.ig ~ exc[exc$dps == 7 & exc$sal.treat.x == "amb",]$incr_growth, pch = 21, bg = col.ta)
points(exc[exc$dps == 12 & exc$sal.treat.x == "amb",]$prob.est.ig ~ exc[exc$dps == 12 & exc$sal.treat.x == "amb",]$incr_growth, pch = 21, bg = col.ta)
points(exc[exc$dps == 39 & exc$sal.treat.x == "amb",]$prob.est.ig ~ exc[exc$dps == 39 & exc$sal.treat.x == "amb",]$incr_growth, pch = 21, bg = col.ta)

plot(exc[exc$sal.treat.x == "low",]$prob.est.ig ~ exc[exc$sal.treat.x == "low",]$incr_growth, pch = 21, type = "n")
points(exc[exc$dps == 7 & exc$sal.treat.x == "low",]$prob.est.ig ~ exc[exc$dps == 7 & exc$sal.treat.x == "low",]$incr_growth, pch = 21, bg = col.ta)
points(exc[exc$dps == 12 & exc$sal.treat.x == "low",]$prob.est.ig ~ exc[exc$dps == 12 & exc$sal.treat.x == "low",]$incr_growth, pch = 21, bg = col.ta)
points(exc[exc$dps == 39 & exc$sal.treat.x == "low",]$prob.est.ig ~ exc[exc$dps == 39 & exc$sal.treat.x == "low",]$incr_growth, pch = 21, bg = col.ta)


summary(lm(dat[dat$sal.treat.x == "amb",]$grow.ratio ~ log(dat[dat$sal.treat.x == "amb",]$dps) + log(dat[dat$sal.treat.x == "amb",]$med.ta)))
# the output says: there is an increase in the growth ratio and it looks like a saturating curve. however, the curve does not differ between TA levels in ambient salinity

summary(lm(dat[dat$sal.treat.x == "low",]$grow.ratio ~ log(dat[dat$sal.treat.x == "low",]$dps) + log(dat[dat$sal.treat.x == "low",]$med.ta)))
# the output says: there is an increase in the growth ratio and it looks like a saturating curve. Also, that as the TA increases, so does the growth ratio
```

creating new columns for grouping by time, and treatment combo...also creating new subsetting df for each time stamp we are interested in
```{r}
dat$size = NA
dat[dat$SA.start < 100,]$size <- "small"
dat[dat$SA.start > 200,]$size <- "large"
dat[dat$SA.start > 100 & dat$SA.start < 200,]$size <- "medium"
dat$group = 0
dat[dat$TA.treat.x == 1000 & dat$sal.treat.x == "low",]$group <- "low.1"
dat[dat$TA.treat.x == 3000 & dat$sal.treat.x == "low",]$group <- "low.3"
dat[dat$TA.treat.x == 1000 & dat$sal.treat.x == "amb",]$group <- "amb.1"
dat[dat$TA.treat.x == 3000 & dat$sal.treat.x == "amb",]$group <- "amb.3"
dat[dat$TA.treat.x == 2000 & dat$sal.treat.x == "low",]$group <- "low.2"
dat[dat$TA.treat.x == 2000 & dat$sal.treat.x == "amb",]$group <- "amb.2"
#subsetting data into specific time points
dat$dps.chr = "all"
  dat[dat$dps == 0,]$dps.chr <- "start"
  dat[dat$dps == 7,]$dps.chr <- "mid"
  dat[dat$dps == 15,]$dps.chr <- "mid2"
  dat[dat$dps == 29,]$dps.chr <- "mid3"
  dat[dat$dps == 36,]$dps.chr <- "end"
start = dat[dat$dps == 0,]
mid = dat[dat$dps == 7,]
mid2 = dat[dat$dps == 15,]
mid3 = dat[dat$dps == 29,]
end = dat[dat$dps == 36,]
#subsetting data into high S or low S
high.s = dat[dat$sal.treat.x == "amb",]
low.s = dat[dat$sal.treat.x == "low",]
```
DATA TREATMENT VISUALIZATION
```{r}
par(mfrow = c(1,1))
sw = sw[sw$TA.treat != "amb",]
#TA vs target; sal as color
plot(sw$TA ~ sw$TA.treat, pch = 19, col = as.factor(sw$Sal.treat), xlab = "TA treatment", ylab = "Measured TA")
#pH vs TA; sal as color
plot(sw$pH ~ sw$TA, pch = 19, col = as.factor(sw$Sal.treat), xlab = "TA measured", ylab = "pH TA") #pH is decoupled from TA at low TA treatments across both salinities, however, at TA > 2000, pH does not vary across the two S treatments
```
GROWTH RATE VISUALIZATION; as distributions binned by TA OR S lumped and then parsed into 3 size classes (based on percentiles from full dataset)
```{r}
#looking at distribution of growth based on treatments...
  # Combined histograms
  red <- rgb (1, 0, 0, alpha=0.5) 
  green <- rgb (1, 1, 0, alpha=0.5)
  blue <- rgb (0, 0, 1, alpha=0.5)
#all sizes lumped together
hist(mid[mid$TA.treat.x == 2000,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "7 dps", main = "all sizes")
    hist(mid[mid$TA.treat.x == 1000,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid[mid$TA.treat.x == 3000,]$grow.ratio, add=T, col=blue,probability=T)
    #now as a violin plot? 
    library(vioplot)
    vioplot(mid$grow.ratio ~ mid$TA.treat.x + mid$sal.treat.x + mid$size,
        col = "white",               # Color of the area
        rectCol = as.factor(mid$size),       # Color of the rectangle
        lineCol = "black",     # Color of the line
        colMed = "green",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        plotCentre = "points") # If "line", plots a median line
    
#small individuals (<100mm2 start SA)
    hist(mid[mid$TA.treat.x == 2000& mid$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "7 dps", main = "small < 100 mm2 start")
    hist(mid[mid$TA.treat.x == 1000& mid$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid[mid$TA.treat.x == 3000& mid$SA.start < 100,]$grow.ratio, add=T, col=blue,probability=T)
    
    hist(mid2[mid2$TA.treat.x == 2000& mid2$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "15 dps", main = "small < 100 mm2 start")
    hist(mid2[mid2$TA.treat.x == 1000& mid2$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid2[mid2$TA.treat.x == 3000& mid2$SA.start < 100,]$grow.ratio, add=T, col=blue,probability=T)    
    
    hist(mid3[mid3$TA.treat.x == 2000& mid3$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "29 dps", main = "small < 100 mm2 start")
    hist(mid3[mid3$TA.treat.x == 1000& mid3$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid3[mid3$TA.treat.x == 3000& mid3$SA.start < 100,]$grow.ratio, add=T, col=blue,probability=T)    
    
    hist(end[end$TA.treat.x == 2000& end$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "36 dps", main = "small < 100 mm2 start")
    hist(end[end$TA.treat.x == 1000& end$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
    hist(end[end$TA.treat.x == 3000& end$SA.start < 100,]$grow.ratio, add=T, col=blue,probability=T)    
    
#large individuals (>200mm2 start SA)
    hist(mid[mid$TA.treat.x == 2000& mid$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "7 dps", main = "large > 200 mm2 start")
    hist(mid[mid$TA.treat.x == 1000& mid$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid[mid$TA.treat.x == 3000& mid$SA.start > 200,]$grow.ratio, add=T, col=blue,probability=T)
    
    hist(mid2[mid2$TA.treat.x == 2000& mid2$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "15 dps", main = "large > 200 mm2 start")
    hist(mid2[mid2$TA.treat.x == 1000& mid2$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid2[mid2$TA.treat.x == 3000& mid2$SA.start > 200,]$grow.ratio, add=T, col=blue,probability=T)    
    
    hist(mid3[mid3$TA.treat.x == 2000& mid3$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "29 dps", main = "large > 200 mm2 start")
    hist(mid3[mid3$TA.treat.x == 1000& mid3$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid3[mid3$TA.treat.x == 3000& mid3$SA.start > 200,]$grow.ratio, add=T, col=blue,probability=T)    
    
    hist(end[end$TA.treat.x == 2000& end$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "36 dps", main = "large > 200 mm2 start")
    hist(end[end$TA.treat.x == 1000& end$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(end[end$TA.treat.x == 3000& end$SA.start > 200,]$grow.ratio, add=T, col=blue,probability=T)    
    
#medium individuals (>200mm2 start SA)
    hist(mid[mid$TA.treat.x == 2000& mid$SA.start > 100 & mid$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,12), col=red,probability=T, xlab = "7 dps", main = "medium 101-199 mm2 start")
    hist(mid[mid$TA.treat.x == 1000& mid$SA.start > 100 & mid$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid[mid$TA.treat.x == 3000& mid$SA.start > 100 & mid$SA.start < 200,]$grow.ratio, add=T, col=blue,probability=T)
    
    hist(mid2[mid2$TA.treat.x == 2000& mid2$SA.start > 100 & mid2$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,12), col=red,probability=T, xlab = "15 dps", main = "medium 101-199 mm2 start")
    hist(mid2[mid2$TA.treat.x == 1000& mid2$SA.start > 100 & mid2$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid2[mid2$TA.treat.x == 3000& mid2$SA.start > 100 & mid2$SA.start < 200,]$grow.ratio, add=T, col=blue,probability=T)    
    
    hist(mid3[mid3$TA.treat.x == 2000& mid3$SA.start > 100 & mid3$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,12), col=red,probability=T, xlab = "29 dps", main = "medium 101-199 mm2 start")
    hist(mid3[mid3$TA.treat.x == 1000& mid3$SA.start > 100 & mid3$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(mid3[mid3$TA.treat.x == 3000& mid3$SA.start > 100 & mid3$SA.start < 200,]$grow.ratio, add=T, col=blue,probability=T)    
    
    hist(end[end$TA.treat.x == 2000& end$SA.start > 100 & end$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,12), col=red,probability=T, xlab = "36 dps", main = "medium 101-199 mm2 start")
    hist(end[end$TA.treat.x == 1000& end$SA.start > 100 & end$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)
    hist(end[end$TA.treat.x == 3000& end$SA.start > 100 & end$SA.start < 200,]$grow.ratio, add=T, col=blue,probability=T)    
    
#COLORED BY SALINITY TREATMENT
#all sizes lumped together
    hist(mid[mid$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "7 dps", main = "all sizes")
    hist(mid[mid$sal.treat.x == "low",]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid2[mid2$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "15 dps", main = NA)
    hist(mid2[mid2$sal.treat.x == "low",]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid3[mid3$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "29 dps", main = NA)
    hist(mid3[mid3$sal.treat.x == "low",]$grow.ratio, add=T, col=green,probability=T)
    
    hist(end[end$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "36 dps", main = NA)
    hist(end[end$sal.treat.x == "low",]$grow.ratio, add=T, col=green,probability=T)

#small sizes lumped together
    hist(mid[mid$sal.treat.x == "amb"& mid$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "7 dps", main = "SMALL sizes")
    hist(mid[mid$sal.treat.x == "low"& mid$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid2[mid2$sal.treat.x == "amb"& mid2$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "15 dps", main = NA)
    hist(mid2[mid2$sal.treat.x == "low"& mid2$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid3[mid3$sal.treat.x == "amb"& mid3$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "29 dps", main = NA)
    hist(mid3[mid3$sal.treat.x == "low"& mid3$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(end[end$sal.treat.x == "amb"& end$SA.start < 100,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "36 dps", main = NA)
    hist(end[end$sal.treat.x == "low"& end$SA.start < 100,]$grow.ratio, add=T, col=green,probability=T)
#large sizes lumped together
    hist(mid[mid$sal.treat.x == "amb"& mid$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "7 dps", main = "LARGE sizes")
    hist(mid[mid$sal.treat.x == "low"& mid$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid2[mid2$sal.treat.x == "amb"& mid2$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "15 dps", main = NA)
    hist(mid2[mid2$sal.treat.x == "low"& mid2$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid3[mid3$sal.treat.x == "amb"& mid3$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "29 dps", main = NA)
    hist(mid3[mid3$sal.treat.x == "low"& mid3$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(end[end$sal.treat.x == "amb"& end$SA.start > 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "36 dps", main = NA)
    hist(end[end$sal.treat.x == "low"& end$SA.start > 200,]$grow.ratio, add=T, col=green,probability=T)
#medium sizes lumped together
    hist(mid[mid$sal.treat.x == "amb"& mid$SA.start > 100 & mid$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "7 dps", main = "med sizes")
    hist(mid[mid$sal.treat.x == "low"& mid$SA.start > 100 & mid$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid2[mid2$sal.treat.x == "amb"& mid2$SA.start > 100 & mid2$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "15 dps", main = NA)
    hist(mid2[mid2$sal.treat.x == "low"& mid2$SA.start > 100 & mid2$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(mid3[mid3$sal.treat.x == "amb"& mid3$SA.start > 100 & mid3$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "29 dps", main = NA)
    hist(mid3[mid3$sal.treat.x == "low"& mid3$SA.start > 100 & mid3$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)
    
    hist(end[end$sal.treat.x == "amb"& end$SA.start > 100 & end$SA.start < 200,]$grow.ratio, xlim=c(0.6,1.8),ylim=c(0,8), col=red,probability=T, xlab = "36 dps", main = NA)
    hist(end[end$sal.treat.x == "low"& end$SA.start > 100 & end$SA.start < 200,]$grow.ratio, add=T, col=green,probability=T)

```
GROWTH RATE VISUALIZATION; as distributions subset as either high/low S and then binned by TA; and violin binning size groups
```{r}
#looking at distribution of growth based on treatments...
  # Combined histograms
      
#binned by S violin plot of TA and size differences; all time points
      #https://r-coder.com/violin-plot-r/?utm_content=cmp-true
vioplot(high.s$grow.ratio ~ high.s$TA.treat.x + high.s$size,
        col = "grey",               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.6,1.8),
        plotCentre = "points") # If "line", plots a median line
vioplot(low.s$grow.ratio ~ low.s$TA.treat.x + low.s$size,
        col = "grey",               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.6,1.8),
        plotCentre = "points") # If "line", plots a median line

#now separated by time
par(mfrow = c(1,1))
#low S
col1 = adjustcolor( "grey30", alpha.f = 0.25)
col2 = adjustcolor( "grey30", alpha.f = 0.25)
col3 = adjustcolor( "grey30", alpha.f = 0.25)
col4 = adjustcolor( "grey30", alpha.f = 0.25)
vioplot(low.s[low.s$dps == 7,]$grow.ratio ~ low.s[low.s$dps == 7,]$size + low.s[low.s$dps == 7,]$TA.treat.x,
        col = col1,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        las = 1,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
vioplot(low.s[low.s$dps == 15,]$grow.ratio ~ low.s[low.s$dps == 15,]$size + low.s[low.s$dps == 15,]$TA.treat.x,
        col = col2,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        add = T,
        las = 1,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
vioplot(low.s[low.s$dps == 29,]$grow.ratio ~ low.s[low.s$dps == 29,]$size + low.s[low.s$dps == 29,]$TA.treat.x,
        col = col3,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),        
        horizontal = T,
        las = 1,
        lwd = 2,
        add = T,
        plotCentre = "points") # If "line", plots a median line
vioplot(low.s[low.s$dps == 36,]$grow.ratio ~ low.s[low.s$dps == 36,]$size + low.s[low.s$dps == 36,]$TA.treat.x,
        col = col4,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        lwd = 2,
        horizontal = T,
        las = 1,
        add = T,
        plotCentre = "points") # If "line", plots a median line
abline(v=1, lwd = 3, col = "goldenrod")
   
#high S
par(mar=c(5,7,2,1))
vioplot(high.s[high.s$dps == 7,]$grow.ratio ~ high.s[high.s$dps == 7,]$size + high.s[high.s$dps == 7,]$TA.treat.x,
        col = col1,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        las = 1,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
vioplot(high.s[high.s$dps == 15,]$grow.ratio ~ high.s[high.s$dps == 15,]$size + high.s[high.s$dps == 15,]$TA.treat.x,
        col = col2,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        add = T,
        las = 1,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
vioplot(high.s[high.s$dps == 29,]$grow.ratio ~ high.s[high.s$dps == 29,]$size + high.s[high.s$dps == 29,]$TA.treat.x,
        col = col3,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),        
        horizontal = T,
        las = 1,
        lwd = 2,
        add = T,
        plotCentre = "points") # If "line", plots a median line
vioplot(high.s[high.s$dps == 36,]$grow.ratio ~ high.s[high.s$dps == 36,]$size + high.s[high.s$dps == 36,]$TA.treat.x,
        col = col4,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        lwd = 2,
        horizontal = T,
        las = 1,
        add = T,
        plotCentre = "points") # If "line", plots a median line
abline(v=1, lwd = 3, col = "goldenrod")



#all sizes lumped
vioplot(high.s[high.s$dps == 15,]$grow.ratio ~ high.s[high.s$dps == 15,]$TA.treat.x,
        col = col1,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        las = 1,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
vioplot(high.s[high.s$dps == 36,]$grow.ratio ~ high.s[high.s$dps == 36,]$TA.treat.x,
        col = col1,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        las = 1,
        add = T,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
abline(v=1, lwd = 3, col = "goldenrod")
vioplot(low.s[low.s$dps == 15,]$grow.ratio ~ low.s[low.s$dps == 15,]$TA.treat.x,
        col = col1,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        las = 1,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
vioplot(low.s[low.s$dps == 36,]$grow.ratio ~ low.s[low.s$dps == 36,]$TA.treat.x,
        col = col1,               # Color of the area
        lineCol = "black",     # Color of the line
        colMed = "black",      # Pch symbol color
        border = "black",      # Color of the border of the violin
        pchMed = 16,           # Pch symbol for the median
        method = "jitter",
        ylim = c(0.75,1.6),
        horizontal = T,
        las = 1,
        add = T,
        lwd = 2,
        plotCentre = "points") # If "line", plots a median line
```
testing the effect of TA on growth ratios within the two salinities; and then also looking at size as a factor? 
```{r}
par(mfrow = c(1,1))
#not treating bin as a random effect but need to disclaimer that each bin may be considered a pseudo replicate? 

#looking at the first week "shock effect"
plot(dat[dat$dps == 7,]$grow.ratio ~ dat[dat$dps == 7,]$med.ta , pch = 19)
boxplot(dat[dat$dps == 7,]$grow.ratio ~ dat[dat$dps == 7,]$sal.treat.x , pch = 19)
plot((dat[dat$dps == 7,]$mm2.diff.start)/7 ~ dat[dat$dps == 7,]$SA.start , pch = 21, ylab = "mm2 growth per day", bg = "orchid1")
abline(lm((dat[dat$dps == 7,]$mm2.diff.start)/7 ~ dat[dat$dps == 7,]$SA.start), lwd = 3, col = "orchid1")
#checking the sizes and distributions of the plates
vioplot(dat[dat$dps == 7,]$SA.start ~ dat[dat$dps == 7,]$Plate.x)
summary(aov(SA.start ~ as.factor(Plate.x), data = dat[dat$dps == 7,])) #no difference in start mean of sizes

mod2 = lm(dat[dat$dps == 7,]$grow.ratio ~ dat[dat$dps == 7,]$med.ta + dat[dat$dps == 7,]$med.S + dat[dat$dps == 7,]$med.pH + dat[dat$dps == 7,]$SA.start)
summary(mod2)
#in this case, salinity was an important factor with higher S resulting in higher growth rate. not surprising because they were prior acclimated to ambient SW salinity conditions. additionally, pH was significant along with the starting size, with smaller individuals growing more than larger individuals after 7 days

#now looking at day 15, which should mean fully acclimated
plot(dat[dat$dps == 15,]$grow.ratio ~ dat[dat$dps == 15,]$med.ta , pch = 19)
boxplot(dat[dat$dps == 15,]$grow.ratio ~ dat[dat$dps == 15,]$sal.treat.x , pch = 19)
plot((dat[dat$dps == 15,]$mm2.diff.start)/15 ~ dat[dat$dps == 15,]$SA.start , pch = 21, ylab = "mm2 growth per day", bg = "orchid3")
abline(lm((dat[dat$dps == 15,]$mm2.diff.start)/15 ~ dat[dat$dps == 15,]$SA.start), lwd = 3, col = "orchid3")

summary(aov(SA.start ~ as.factor(Plate.x), data = dat[dat$dps == 15,])) #no difference in start mean of sizes left

mod3 = lm(dat[dat$dps == 15,]$grow.ratio ~ dat[dat$dps == 15,]$med.ta + dat[dat$dps == 15,]$med.S + dat[dat$dps == 15,]$med.pH + dat[dat$dps == 15,]$SA.start)
summary(mod3)
#after 15 days post acclimation, pH and size were not a factor, however oysters in lower salinity grew more than those in ambient conditions. TA was also not a factor.

#finally, the end time stamp
plot(dat[dat$dps == 36,]$grow.ratio ~ dat[dat$dps == 36,]$med.ta , pch = 19)
boxplot(dat[dat$dps == 36,]$grow.ratio ~ dat[dat$dps == 36,]$sal.treat.x , pch = 19)
plot((dat[dat$dps == 36,]$mm2.diff.start)/36 ~ dat[dat$dps == 36,]$SA.start , pch = 21, bg = "orchid4", ylab = "mm2 growth per day")
abline(lm((dat[dat$dps == 36,]$mm2.diff.start)/36 ~ dat[dat$dps == 36,]$SA.start), lwd = 3, col = "orchid4")
summary(aov(SA.start ~ as.factor(Plate.x), data = dat[dat$dps == 36,])) #no difference in start mean of sizes left

mod1 = lm(dat[dat$dps == 36,]$grow.ratio ~ dat[dat$dps == 36,]$med.ta + dat[dat$dps == 36,]$med.S + dat[dat$dps == 36,]$med.pH + dat[dat$dps == 36,]$SA.start)
summary(mod1)
#no effect of starting size or of Salinity on final growth ratio; effect of TA and pH treatment...
mod.phta = lm(sw$pH ~ sw$TA + sw$S)
summary(mod.phta)
#however pH and TA are correlated...sooooo. need to sort that out; but, S is not correlated to pH.



#looking at all of the growth rate (mm2/day) vs starting size together...
plot((dat[dat$dps == 7,]$mm2.diff.start)/7 ~ dat[dat$dps == 7,]$SA.start , pch = 21, ylab = "mm2 growth per day", bg = "orchid1")
abline(lm((dat[dat$dps == 7,]$mm2.diff.start)/7 ~ dat[dat$dps == 7,]$SA.start), lwd = 3, col = "orchid1")

points((dat[dat$dps == 15,]$mm2.diff.start)/15 ~ dat[dat$dps == 15,]$SA.start , pch = 21, ylab = "mm2 growth per day", bg = "orchid3")
abline(lm((dat[dat$dps == 15,]$mm2.diff.start)/15 ~ dat[dat$dps == 15,]$SA.start), lwd = 3, col = "orchid3")

points((dat[dat$dps == 36,]$mm2.diff.start)/36 ~ dat[dat$dps == 36,]$SA.start , pch = 21, ylab = "mm2 growth per day", bg = "orchid4")
abline(lm((dat[dat$dps == 36,]$mm2.diff.start)/36 ~ dat[dat$dps == 36,]$SA.start), lwd = 3, col = "orchid4")
#shows that between 7 and 15 days, growth rates increased for larger individuals but did not change between 15 and 36 days

```




creating size bins for data
```{r}
dat$size = NA
dat[dat$SA.start < 100,]$size <- "small"
dat[dat$SA.start > 100 & dat$SA.start < 200,]$size <- "medium"
dat[dat$SA.start > 200,]$size <- "large"
```
---------------HIGH SALINITY-----------------------------
1. define kernel density lines for each size/TA bin, across time points in ambient salinity.
```{r}
kd1.7 <- density(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd1.7s <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd1.7m <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd1.7l <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)
kd2.7 <- density(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd2.7s <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd2.7m <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd2.7l <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)
kd3.7 <- density(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd3.7s <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd3.7m <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd3.7l <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 7 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)

kd1.15 <- density(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd1.15s <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd1.15m <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd1.15l <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)
kd2.15 <- density(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd2.15s <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd2.15m <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd2.15l <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)
kd3.15 <- density(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd3.15s <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd3.15m <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd3.15l <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 15 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)

kd1.36 <- density(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd1.36s <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd1.36m <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd1.36l <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)
kd2.36 <- density(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd2.36s <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd2.36m <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd2.36l <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)
kd3.36 <- density(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio)
      kd3.36s <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "small",]$grow.ratio)
      kd3.36m <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "medium",]$grow.ratio)
      kd3.36l <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 36 
              & dat$sal.treat.x == "amb"
              & dat$size == "large",]$grow.ratio)
```

looking at just density lines
```{r}
#by date
plot(kd1.7s, ylim = c(0,12))
  lines(kd1.7m)
  lines(kd1.7l)
  lines(kd1.7s)
  
  lines(kd2.7s)
  lines(kd2.7m)
  lines(kd2.7l)
  
  lines(kd3.7s)
  lines(kd3.7m)
  lines(kd3.7l)
  
plot(kd1.15s, ylim = c(0,12))
  lines(kd1.15m)
  lines(kd1.15l)
  lines(kd1.15s)
  
  lines(kd2.15s)
  lines(kd2.15m)
  lines(kd2.15l)
  
  lines(kd3.15s)
  lines(kd3.15m)
  lines(kd3.15l)
  
plot(kd1.36s, ylim = c(0,12))
  lines(kd1.36m)
  lines(kd1.36l)
  lines(kd1.36s)
  
  lines(kd2.36s)
  lines(kd2.36m)
  lines(kd2.36l)
  
  lines(kd3.36s)
  lines(kd3.36m)
  lines(kd3.36l)
#binned by TA
plot(kd1.7, ylim = c(0,12))
  lines(kd1.7m)
  lines(kd1.7l)
  lines(kd1.7s)
  lines(kd1.15s)
  lines(kd1.15m)
  lines(kd1.15l)
  lines(kd1.36m)
  lines(kd1.36l)
  lines(kd1.36s)
plot(kd2.7, ylim = c(0,12))
  lines(kd2.7m)
  lines(kd2.7l)
  lines(kd2.7s)
  lines(kd2.15s)
  lines(kd2.15m)
  lines(kd2.15l)
  lines(kd2.36m)
  lines(kd2.36l)
  lines(kd2.36s)
plot(kd3.7, ylim = c(0,12))
  lines(kd3.7m)
  lines(kd3.7l)
  lines(kd3.7s)
  lines(kd3.15s)
  lines(kd3.15m)
  lines(kd3.15l)
  lines(kd3.36m)
  lines(kd3.36l)
  lines(kd3.36s)
  
  

```
EFFECT OF SIZE AND ALKALINITY ON AVERAGE GROWTH RATIO AT DPS = 7, 15, 36
mean growth ratio within: HIGH SALINITY
        among: SIZE CLASSES + TA LEVELS
stat test: 
overall, looks like the mean growth ratio is similar within size classes across the TA treatments at each time interval, however, the mid TA level often has a steeper peak than low and high TA
```{r}
red <- rgb (1, 0, 0, alpha=0.15) 
green <- rgb (1, 1, 0, alpha=0.15)
blue <- rgb (0, 0, 1, alpha=0.15)
par(mfrow = c(2,2))
#dps = 7
      #all sizes: similar N values
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "7 dps", main = "all sizes")
  lines(kd2.7,lwd = 3, col = "red", lty = 1)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7,lwd = 3, col = "goldenrod4", lty = 1)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7,lwd = 3, col = "blue", lty = 1)
  #takeaways: means look similar in all cases; mid TA has highest peak (fewer outliers) whereas the spread in the other two is similar (more outliers)
  
      #small
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "amb" & dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "7 dps", main = "small")
  lines(kd2.7s,lwd = 3, col = "red", lty = 1)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "amb"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7s,lwd = 3, col = "goldenrod4", lty = 1)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "amb"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7s,lwd = 3, col = "blue", lty = 1)
  
      #medium
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "amb" & dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,12), col=red, probability=T, xlab = "7 dps", main = "medium")
  lines(kd2.7m,lwd = 3, col = "red", lty = 1)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "amb"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7m,lwd = 3, col = "goldenrod4", lty = 1)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "amb"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7m,lwd = 3, col = "blue", lty = 1)
  
      #large
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "amb" & dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "7 dps", main = "large")
  lines(kd2.7l,lwd = 3, col = "red", lty = 1)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "amb"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7l,lwd = 3, col = "goldenrod4", lty = 1)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "amb"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7l,lwd = 3, col = "blue", lty = 1)

#dps = 15
      #all sizes
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "all sizes")
  lines(kd2.15,lwd = 3, col = "red", lty = 2)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15,lwd = 3, col = "goldenrod4", lty = 2)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15,lwd = 3, col = "blue", lty = 2)
  #takeaways: all peaks are a similar height and means look similar
  
      #small
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "amb" & dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "small")
  lines(kd2.15s,lwd = 3, col = "red", lty = 2)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "amb"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15s,lwd = 3, col = "goldenrod4", lty = 2)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "amb"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15s,lwd = 3, col = "blue", lty = 2)
  
      #medium
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "amb" & dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,12), col=red, probability=T, xlab = "15 dps", main = "medium")
  lines(kd2.15m,lwd = 3, col = "red", lty = 2)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "amb"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15m,lwd = 3, col = "goldenrod4", lty = 2)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "amb"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15m,lwd = 3, col = "blue", lty = 2)
  
      #large
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "amb" & dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "large")
  lines(kd2.15l,lwd = 3, col = "red", lty = 2)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "amb"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15l,lwd = 3, col = "goldenrod4", lty = 2)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "amb"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15l,lwd = 3, col = "blue", lty = 2)


#dps = 36
      #all sizes
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "all sizes")
  lines(kd2.36,lwd = 3, col = "red", lty = 3)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36,lwd = 3, col = "goldenrod4", lty = 3)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36,lwd = 3, col = "blue", lty = 3)
  
      #small
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "amb" & dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "small")
  lines(kd2.36s,lwd = 3, col = "red", lty = 3)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "amb"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36s,lwd = 3, col = "goldenrod4", lty = 3)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "amb"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36s,lwd = 3, col = "blue", lty = 3)
  
      #medium
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "amb" & dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,12), col=red, probability=T, xlab = "36 dps", main = "medium")
  lines(kd2.36m,lwd = 3, col = "red", lty = 3)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "amb"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36m,lwd = 3, col = "goldenrod4", lty = 3)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "amb"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36m,lwd = 3, col = "blue", lty = 3)
  
      #large
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "amb" & dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "large")
  lines(kd2.36l,lwd = 3, col = "red", lty = 3)
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "amb"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36l,lwd = 3, col = "goldenrod4", lty = 3)
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "amb"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36l,lwd = 3, col = "blue", lty = 3)
```

EFFECT OF TIME ON GROWTH RATIO (ACCLIMATION DIFFERENCES) WITHIN EACH TREATMENT GROUP
mean growth ratio within: TREATMENT GROUP (TA/S) + SIZE
                  #across time: 7 VS 15 VS 36 DPS
stat test? X
```{r}
#all sizes:
par(mfrow = c(3,1))
#mid TA_ all sizes
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "growth (x:start)", main = "all sizes")
  lines(kd2.7,lwd = 3, col = "red1", lty = 1)
  hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd2.15,lwd = 3, col = "red3", lty = 2)
  hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd2.36,lwd = 3, col = "red4", lty = 3)

#amb TA_ all sizes
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "growth (x:start)", main = "all sizes")
  lines(kd1.7,lwd = 3, col = "goldenrod1", lty = 1)
  hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15,lwd = 3, col = "goldenrod3", lty = 2)
  hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36,lwd = 3, col = "goldenrod4", lty = 3)
  
#high TA_ all sizes
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "growth (x:start)", main = "all sizes")
  lines(kd3.7,lwd = 3, col = "blue1", lty = 1)
  hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15,lwd = 3, col = "blue3", lty = 2)
  hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "amb",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36,lwd = 3, col = "blue4", lty = 3)

  
#binned by TA and size (looks at the acclimation differences?)
par(mfrow = c(1,1))
  #low small
  plot(kd1.7s, ylim = c(0,8), lwd = 2, xlim = c(0.7,1.5),col = "goldenrod1", main = "amb S: small size, low TA", xlab = "growth (x:start)")
  lines(kd1.15s, lty = 2, lwd = 2,col = "goldenrod3")
  lines(kd1.36s, lty = 3, lwd = 2,col = "goldenrod4")
  
  #low medium
  plot(kd1.7m, ylim = c(0,8), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "goldenrod1", main = "amb S: medium size, low TA", xlab = "growth (x:start)")
  lines(kd1.15m, lty = 2, lwd = 2,col = "goldenrod3")
  lines(kd1.36m, lty = 3, lwd = 2,col = "goldenrod4")
  
  #low large
  plot(kd1.7l, ylim = c(0,8), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "goldenrod1", main = "amb S: large size, low TA", xlab = "growth (x:start)")
  lines(kd1.15l, lty = 2, lwd = 2,col = "goldenrod3")
  lines(kd1.36l, lty = 3, lwd = 2,col = "goldenrod4")
  
   #mid small
  plot(kd2.7s, ylim = c(0,6.5), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "red1", main = "amb S: small size, mod TA", xlab = "growth (x:start)")
  lines(kd2.15s, lty = 2, lwd = 2,col = "red3")
  lines(kd2.36s, lty = 3, lwd = 2,col = "red4")
  
  #mid medium
  plot(kd2.7m, ylim = c(0,12), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "red1", main = "amb S: medium size, mod TA", xlab = "growth (x:start)")
  lines(kd2.15m, lty = 2, lwd = 2,col = "red3")
  lines(kd2.36m, lty = 3, lwd = 2,col = "red4")
  
  #mid large
  plot(kd2.7l, ylim = c(0,10), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "red1", main = "amb S: large size, mod TA", xlab = "growth (x:start)")
  lines(kd2.15, lty = 2, lwd = 2,col = "red3")
  lines(kd2.36l, lty = 3, lwd = 2,col = "red4")
  
  #high small
  plot(kd3.7s, ylim = c(0,8), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "blue1", main = "amb S: small size, high TA", xlab = "growth (x:start)")
  lines(kd3.15s, lty = 2, lwd = 2,col = "blue3")
  lines(kd3.36s, lty = 3, lwd = 2,col = "blue4")
  
  #high medium
  plot(kd3.7m, ylim = c(0,6), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "blue1", main = "amb S: medium size, high TA", xlab = "growth (x:start)")
  lines(kd3.15m, lty = 2, lwd = 2,col = "blue3")
  lines(kd3.36m, lty = 3, lwd = 2,col = "blue4")
  
  #high large
  plot(kd3.7l, ylim = c(0,6), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "blue1", main = "amb S: large size, high TA", xlab = "growth (x:start)")
  lines(kd3.15l, lty = 2, lwd = 2,col = "blue3")
  lines(kd3.36l, lty = 3, lwd = 2,col = "blue4")

```

-----------LOW SALINITY DATA BELOW-----------------------
1. define kernel density lines for each size/TA bin, across time points in low salinity.
```{r}
kd1.7 <- density(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio)
      kd1.7s <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd1.7m <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd1.7l <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)
kd2.7 <- density(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio)
      kd2.7s <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd2.7m <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd2.7l <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)
kd3.7 <- density(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio)
      kd3.7s <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd3.7m <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd3.7l <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 7 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)

kd1.15 <- density(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio)
      kd1.15s <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd1.15m <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd1.15l <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)
kd2.15 <- density(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio)
      kd2.15s <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd2.15m <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd2.15l <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)
kd3.15 <- density(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio)
      kd3.15s <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd3.15m <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd3.15l <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 15 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)

kd1.36 <- density(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio)
      kd1.36s <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd1.36m <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd1.36l <- density(dat[dat$TA.treat.x == 1000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)
kd2.36 <- density(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio)
      kd2.36s <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd2.36m <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd2.36l <- density(dat[dat$TA.treat.x == 2000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)
kd3.36 <- density(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio)
      kd3.36s <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "small",]$grow.ratio)
      kd3.36m <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "medium",]$grow.ratio)
      kd3.36l <- density(dat[dat$TA.treat.x == 3000 
              & dat$dps == 36 
              & dat$sal.treat.x == "low"
              & dat$size == "large",]$grow.ratio)
```

EFFECT OF SIZE AND ALKALINITY ON AVERAGE GROWTH RATIO AT DPS = 7, 15, 36
mean growth ratio within: LOW SALINITY
        among: SIZE CLASSES + TA LEVELS
stat test? X
```{r}
red <- rgb (1, 0, 0, alpha=0.15) 
green <- rgb (0, 1, 0, alpha=0.15)
blue <- rgb (0, 0, 1, alpha=0.15)
par(mfrow = c(2,2))
#dps = 7
      #all sizes
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "7 dps", main = "all sizes")
  lines(kd2.7,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7,lwd = 3, col = "blue")
  #takeaways: means look similar in all cases
  
      #small
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "low" & dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "7 dps", main = "small")
  lines(kd2.7s,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "low"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7s,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "low"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7s,lwd = 3, col = "blue")
  
      #medium
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "low" & dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,12), col=red, probability=T, xlab = "7 dps", main = "medium")
  lines(kd2.7m,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "low"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7m,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "low"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7m,lwd = 3, col = "blue")
  
      #large
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "low" & dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "7 dps", main = "large")
  lines(kd2.7l,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "low"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd1.7l,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "low"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes", add = T)
  lines(kd3.7l,lwd = 3, col = "blue")

#dps = 15
      #all sizes
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "all sizes")
  lines(kd2.15,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15,lwd = 3, col = "blue")
  #takeaways: 
  
      #small
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "low" & dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "small")
  lines(kd2.15s,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "low"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15s,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "low"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15s,lwd = 3, col = "blue")
  
      #medium
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "low" & dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,12), col=red, probability=T, xlab = "15 dps", main = "medium")
  lines(kd2.15m,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "low"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15m,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "low"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15m,lwd = 3, col = "blue")
  
      #large
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "low" & dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "large")
  lines(kd2.15l,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "low"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15l,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "low"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15l,lwd = 3, col = "blue")


#dps = 36
      #all sizes
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "all sizes")
  lines(kd2.36,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36,lwd = 3, col = "blue")
  
      #small
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "low" & dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "small")
  lines(kd2.36s,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "low"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36s,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "low"& dat$size == "small",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36s,lwd = 3, col = "blue")
  
      #medium
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "low" & dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,12), col=red, probability=T, xlab = "36 dps", main = "medium")
  lines(kd2.36m,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "low"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36m,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "low"& dat$size == "medium",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36m,lwd = 3, col = "blue")
  
      #large
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "low" & dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "large")
  lines(kd2.36l,lwd = 3, col = "red")
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "low"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36l,lwd = 3, col = "goldenrod4")
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "low"& dat$size == "large",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36l,lwd = 3, col = "blue")
```

EFFECT OF TIME ON GROWTH RATIO (ACCLIMATION DIFFERENCES) WITHIN EACH TREATMENT GROUP
mean growth ratio within: TREATMENT GROUP (TA/S) + SIZE
                  #across time: 7 VS 15 VS 36 DPS
stat test? X
```{r}
#all sizes:
par(mfrow = c(3,1))
#mid TA_ all sizes
hist(dat[dat$TA.treat.x == 2000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "7, 15, 36 dps", main = "all sizes")
  lines(kd2.7,lwd = 3, col = "red1", lty = 1)
  hist(dat[dat$TA.treat.x == 2000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd2.15,lwd = 3, col = "red3", lty = 2)
  hist(dat[dat$TA.treat.x == 2000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=red, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd2.36,lwd = 3, col = "red4", lty = 3)

#low TA_ all sizes
hist(dat[dat$TA.treat.x == 1000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "7 dps", main = "all sizes")
  lines(kd1.7,lwd = 3, col = "goldenrod1", lty = 1)
  hist(dat[dat$TA.treat.x == 1000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd1.15,lwd = 3, col = "goldenrod3", lty = 2)
  hist(dat[dat$TA.treat.x == 1000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=green, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd1.36,lwd = 3, col = "goldenrod4", lty = 3)
  
#high TA_ all sizes
hist(dat[dat$TA.treat.x == 3000 & dat$dps == 7 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "7 dps", main = "all sizes")
  lines(kd3.7,lwd = 3, col = "blue1", lty = 1)
  hist(dat[dat$TA.treat.x == 3000 & dat$dps == 15 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "15 dps", main = "all sizes", add = T)
  lines(kd3.15,lwd = 3, col = "blue3", lty = 2)
  hist(dat[dat$TA.treat.x == 3000 & dat$dps == 36 & dat$sal.treat.x == "low",]$grow.ratio, xlim=c(0.6,1.8), ylim=c(0,10), col=blue, probability=T, xlab = "36 dps", main = "all sizes", add = T)
  lines(kd3.36,lwd = 3, col = "blue4", lty = 3)

  
#binned by TA and size (looks at the acclimation differences?)
par(mfrow = c(1,3))
  #low small
  plot(kd1.7s, ylim = c(0,8), lwd = 2, xlim = c(0.7,1.5),col = "goldenrod1", main = "Low S: small size, low TA")
  lines(kd1.15s, lty = 2, lwd = 2,col = "goldenrod3")
  lines(kd1.36s, lty = 3, lwd = 2,col = "goldenrod4")
  
  #low medium
  plot(kd1.7m, ylim = c(0,8), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "goldenrod1", main = "Low S: medium size, low TA")
  lines(kd1.15m, lty = 2, lwd = 2,col = "goldenrod3")
  lines(kd1.36m, lty = 3, lwd = 2,col = "goldenrod4")
  
  #low large
  plot(kd1.7l, ylim = c(0,8), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "goldenrod1", main = "Low S: large size, low TA")
  lines(kd1.15l, lty = 2, lwd = 2,col = "goldenrod3")
  lines(kd1.36l, lty = 3, lwd = 2,col = "goldenrod4")
  
   #mid small
  plot(kd2.7s, ylim = c(0,6.5), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "red1", main = "Low S: small size, mod TA")
  lines(kd2.15s, lty = 2, lwd = 2,col = "red3")
  lines(kd2.36s, lty = 3, lwd = 2,col = "red4")
  
  #mid medium
  plot(kd2.7m, ylim = c(0,12), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "red1", main = "Low S: medium size, mod TA")
  lines(kd2.15m, lty = 2, lwd = 2,col = "red3")
  lines(kd2.36m, lty = 3, lwd = 2,col = "red4")
  
  #mid large
  plot(kd2.7l, ylim = c(0,10), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "red1", main = "Low S: large size, mod TA")
  lines(kd2.15, lty = 2, lwd = 2,col = "red3")
  lines(kd2.36l, lty = 3, lwd = 2,col = "red4")
  
  #high small
  plot(kd3.7s, ylim = c(0,8), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "blue1", main = "Low S: small size, high TA")
  lines(kd3.15s, lty = 2, lwd = 2,col = "blue3")
  lines(kd3.36s, lty = 3, lwd = 2,col = "blue4")
  
  #high medium
  plot(kd3.7m, ylim = c(0,6), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "blue1", main = "Low S: medium size, high TA")
  lines(kd3.15m, lty = 2, lwd = 2,col = "blue3")
  lines(kd3.36m, lty = 3, lwd = 2,col = "blue4")
  
  #high large
  plot(kd3.7l, ylim = c(0,6), lty = 1, lwd = 2, xlim = c(0.7,1.5),col = "blue1", main = "Low S: large size, high TA")
  lines(kd3.15l, lty = 2, lwd = 2,col = "blue3")
  lines(kd3.36l, lty = 3, lwd = 2,col = "blue4")

```

--------------other things--------------------------
looking at organic content
```{r}
boxplot(dat[dat$sal.treat.x == "low",]$`%oc.ic.shell` ~ dat[dat$sal.treat.x == "low",]$TA.treat.x)
plot(dat[dat$sal.treat.x == "low",]$`%oc.ic.shell` ~ dat[dat$sal.treat.x == "low",]$med.pH)
ANOVA1<-aov(`%oc.ic.shell`~as.factor(TA.treat.x),data=dat[dat$sal.treat.x == "low",])
summary(ANOVA1)
TukeyHSD(ANOVA1)

boxplot(dat[dat$sal.treat.x == "amb",]$`%oc.ic.shell` ~ dat[dat$sal.treat.x == "amb",]$TA.treat.x)
plot(dat[dat$sal.treat.x == "amb",]$`%oc.ic.shell` ~ dat[dat$sal.treat.x == "amb",]$med.pH)
ANOVA2<-aov(`%oc.ic.shell`~as.factor(TA.treat.x),data=dat[dat$sal.treat.x == "amb",])
summary(ANOVA2)
TukeyHSD(ANOVA2)

boxplot(dat$`%oc.ic.shell` ~ dat$med.ta, pch = 19)

plot(dat[dat$sal.treat.x == "amb",]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb",]$SA.mm2), pch = 19, col = as.factor(dat[dat$sal.treat.x == "amb",]$TA.treat.x), bty = "n", type = "n")
  points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 1000 & dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 1000& dat$dps == 36,]$SA.mm2), pch = 21, bg = "goldenrod1", cex = 1.15)
  points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 2000 & dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 2000& dat$dps == 36,]$SA.mm2), pch = 21, bg = "red1", cex = 1.15)
  points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 3000 & dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 3000& dat$dps == 36,]$SA.mm2), pch = 21, bg = "blue1", cex = 1.15)

plot(dat[dat$sal.treat.x == "low",]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "low",]$SA.mm2), pch = 19, col = as.factor(dat[dat$sal.treat.x == "low",]$TA.treat.x), bty = "n", type = "n")
  points(dat[dat$sal.treat.x == "low" & dat$TA.treat.x == 1000 & dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "low"& dat$TA.treat.x == 1000& dat$dps == 36,]$SA.mm2), pch = 21, bg = "goldenrod", cex = 1.15)
  points(dat[dat$sal.treat.x == "low" & dat$TA.treat.x == 2000 & dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "low"& dat$TA.treat.x == 2000& dat$dps == 36,]$SA.mm2), pch = 21, bg = "red3", cex = 1.15)
  points(dat[dat$sal.treat.x == "low" & dat$TA.treat.x == 3000 & dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "low"& dat$TA.treat.x == 3000& dat$dps == 36,]$SA.mm2), pch = 21, bg = "blue4", cex = 1.15)
    
plot(dat[dat$sal.treat.x == "amb",]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb",]$shell.wt), pch = 19, col = as.factor(dat[dat$sal.treat.x == "amb",]$TA.treat.x), bty = "n", type = "n")
  points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 1000,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 1000,]$shell.wt), pch = 21, bg = "goldenrod", cex = 1.15)
    points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 2000,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 2000,]$shell.wt), pch = 21, bg = "red3", cex = 1.15)
      points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 3000,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 3000,]$shell.wt), pch = 21, bg = "blue4", cex = 1.15)

plot(dat[dat$sal.treat.x == "amb",]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb",]$shell.wt), pch = 19, col = as.factor(dat[dat$sal.treat.x == "amb",]$TA.treat.x), bty = "n", type = "n")
  points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 1000,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 1000,]$shell.wt), pch = 21, bg = "goldenrod", cex = 1.15)
    points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 2000,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 2000,]$shell.wt), pch = 21, bg = "red3", cex = 1.15)
      points(dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 3000,]$`%oc.ic.shell` ~ log(dat[dat$sal.treat.x == "amb"& dat$TA.treat.x == 3000,]$shell.wt), pch = 21, bg = "blue4", cex = 1.15)
      
      


    mL.1000 <- drm(`%oc.ic.shell` ~ shell.wt, data = dat[dat$sal.treat.x == "low" & dat$TA.treat.x == 1000,], fct = LL.3()) 
        mL.2000 <- drm(`%oc.ic.shell` ~ shell.wt, data = dat[dat$sal.treat.x == "low" & dat$TA.treat.x == 2000,], fct = LL.3()) 
            mL.3000 <- drm(`%oc.ic.shell` ~ shell.wt, data = dat[dat$sal.treat.x == "low" & dat$TA.treat.x == 3000,], fct = LL.3()) 

    mH.1000 <- drm(`%oc.ic.shell` ~ shell.wt, data = dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 1000,], fct = LL.3()) 
        mH.2000 <- drm(`%oc.ic.shell` ~ shell.wt, data = dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 2000,], fct = LL.3()) 
            mH.3000 <- drm(`%oc.ic.shell` ~ shell.wt, data = dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == 3000,], fct = LL.3()) 
    
      
plot(mL.1000, pch = 19, col = "goldenrod2", lwd = 3, cex = .5)
  plot(mL.2000, pch = 19, col = "red3", add = T, lwd = 3, cex = .5)
  plot(mL.3000, pch = 19, col = "blue4", add = T, lwd = 3, cex = .5)
  
plot(mH.1000, pch = 19, col = "goldenrod2", lwd = 3, cex = .5)
  plot(mH.2000, pch = 19, col = "red3", add = T, lwd = 3, cex = .5)
  plot(mH.3000, pch = 19, col = "blue4", add = T, lwd = 3, cex = .5)
      
  
#color spectra
n=10
rbPal = colorRampPalette(c("gold1", "purple4"))

par(mfrow = c(1,1))
col.oc = rbPal(6)[as.numeric(cut(dat$`%oc.ic.shell`, breaks = c(0,1,1.1429,1.3071,1.4754,1.75,2.4584)))]
plot(jitter(dat[dat$sal.treat.x == "low",]$med.ta,600) ~ jitter(dat[dat$sal.treat.x == "low",]$med.pH,10), pch = 21, bg = col.oc, cex = .75)

plot(jitter(dat[dat$sal.treat.x == "amb",]$med.ta,600) ~ jitter(dat[dat$sal.treat.x == "amb",]$med.pH,10), pch = 21, bg = col.oc, cex = 1)

#density kernals for percent organic matter? 
plot(dat$`%oc.ic.shell` ~ dat$shell.wt)
plot(dat$`%oc.ic.shell` ~ dat$gut.wt)
kdp1 <- density(dat[dat$Plate.x == 1,]$`%oc.ic.shell`)
kdp2 <- density(dat[dat$Plate.x == 2,]$`%oc.ic.shell`)
kdp3 <- density(dat[dat$Plate.x == 3,]$`%oc.ic.shell`)
kdp4 <- density(dat[dat$Plate.x == 4,]$`%oc.ic.shell`)
kdp5 <- density(dat[dat$Plate.x == 5,]$`%oc.ic.shell`)
kdp6 <- density(dat[dat$Plate.x == 6,]$`%oc.ic.shell`)
kdp8 <- density(dat[dat$Plate.x == 8,]$`%oc.ic.shell`)
kdp9 <- density(dat[dat$Plate.x == 9,]$`%oc.ic.shell`)
kdp10 <- density(dat[dat$Plate.x == 10,]$`%oc.ic.shell`)
kdp11 <- density(dat[dat$Plate.x == 11,]$`%oc.ic.shell`)
kdp12 <- density(dat[dat$Plate.x == 12,]$`%oc.ic.shell`)
kdp7 <- density(dat[dat$Plate.x == 7,]$`%oc.ic.shell`)

hist(dat[dat$Plate.x == 1,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
lines(kdp1)
hist(dat[dat$Plate.x == 2,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp2)
  hist(dat[dat$Plate.x == 3,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp3)
  hist(dat[dat$Plate.x == 4,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp4)
  hist(dat[dat$Plate.x == 5,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp5)
  hist(dat[dat$Plate.x == 6,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp6)
    hist(dat[dat$Plate.x == 8,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp8)
    hist(dat[dat$Plate.x == 9,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp9)
    hist(dat[dat$Plate.x == 10,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp10)
    hist(dat[dat$Plate.x == 11,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp11)
    hist(dat[dat$Plate.x == 12,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp12)
    hist(dat[dat$Plate.x == 7,]$`%oc.ic.shell`, probability = T, ylim = c(0,3), xlim = c(0,2.5))
  lines(kdp7)
  
mod.tuk = (lm(dat$`%oc.ic.shell` ~ as.factor(dat$sal.treat.x) + dat$med.pH + dat$med.ta))
summary(mod.tuk)

dat$Plate.x <- as.factor(dat$Plate.x)
iris.aov <- (aov(`%oc.ic.shell` ~ Plate.x, data = dat))
iris.tukey <- glht(iris.aov, linfct = mcp(Plate.x = "Tukey"))
cld(iris.tukey)

plot(TukeyHSD(mod.tuk, conf.level=.95, order = T), las = 2)

boxplot(dat$`%oc.ic.shell` ~ dat$Plate.x, group = TRUE)
```

looking at condition index
```{r}
boxplot(dat$CI ~ dat$Plate.x, pch = 19)
iris.aov <- (lm(CI ~ med.ta + med.S + med.pH, data = dat[dat$dps == 36,]))

lm1 <- (lm(`%oc.ic.shell` ~ med.ta + med.S , data = dat[dat$dps == 36,]))
summary(lm1) #TA and S

lm2 <- (lm(CI ~ med.ta + med.S , data = dat[dat$dps == 36,]))
summary(lm2) #only S

#color spectra
n=10
rbPal = colorRampPalette(c("gold1", "purple4"))
par(mfrow = c(1,1))
col.ta = rbPal(6)[as.numeric(cut(dat[dat$dps == 36,]$med.ta, breaks = 5))]
plot(dat[dat$dps == 36,]$med.ta, pch = 19, col = col.ta)
plot(dat[dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$dps == 36,]$SA.mm2), bg = "black", pch = 21, ylim = c(0.5,2), cex = 1.2)
summary(lm(dat[dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$dps == 36,]$SA.mm2)))
abline(0.27465,0.20787, lty = 1, lwd = 4, col = "black")
  points(dat[dat$dps == 36 & dat$SA.start < 100,]$`%oc.ic.shell` ~ log(dat[dat$dps == 36& dat$SA.start < 100,]$SA.mm2), bg = "pink3", cex = 1.2, pch = 21)
    points(dat[dat$dps == 36 & dat$SA.start > 200,]$`%oc.ic.shell` ~ log(dat[dat$dps == 36& dat$SA.start > 200,]$SA.mm2), bg = "red4", cex = 1.2, pch = 21)
      points(dat[dat$dps == 36 & dat$SA.start > 100  & dat$SA.start < 200,]$`%oc.ic.shell` ~ log(dat[dat$dps == 36& dat$SA.start > 100  & dat$SA.start < 200,]$SA.mm2), bg = "salmon", cex = 1.2, pch = 21)
      
boxplot(dat[dat$dps == 36,]$`%oc.ic.shell` ~ (dat[dat$dps == 36,]$size))

abline(v=4.60517)
abline(v=5.298317)


summary(lm(dat[dat$dps == 36,]$`%oc.ic.shell` ~ log(dat[dat$dps == 36,]$SA.mm2) + dat[dat$dps == 36,]$size))
abline(0.27465,(0.20787+4.638e-05), lty = 2, lwd = 3, col = "green")



```
  
_____________________________________old code_____________
```{r}
for(x15 in unique(dat$CV_ID)){
  new = as.data.frame(dat[dat$dps == 15,]$SA.mm2)
    }
new$SA.dps15 <- new$`dat[dat$dps == 15, ]$SA.mm2`
new$CV_ID <- sort(unique(dat[dat$dps == 15,]$CV_ID))

dat1 = merge(dat,new,by = "CV_ID")
dat1$mm2.d.dps15.36 = dat1$SA.mm2-dat1$SA.dps15/11
dat1$mm2.d.dps1.7 = dat1$SA.mm2 - dat1$SA.start/7
dat1$mm2.d.dps1.15 = dat1$SA.mm2 - dat1$SA.start/15

boxplot(dat1[dat1$dps == 36,]$mm2.d.dps15.36 ~ dat1[dat1$dps == 36,]$TA.treat.x + dat1[dat1$dps == 36,]$sal.treat.x)
boxplot(dat1[dat1$dps == 7,]$mm2.d.dps1.7 ~ dat1[dat1$dps == 7,]$TA.treat.x + dat1[dat1$dps == 7,]$sal.treat.x)
boxplot(dat1[dat1$dps == 15,]$mm2.d.dps1.15 ~ dat1[dat1$dps == 15,]$TA.treat.x + dat1[dat1$dps == 15,]$sal.treat.x)

plot(dat1[dat1$dps == 36,]$gro.rat.day.15 ~ dat1[dat1$dps == 36,]$grow.ratio, pch = 19, col = as.factor(dat1[dat1$dps == 15,]$TA.treat.x))
abline(0,1)


```



testing whether a distribution has changed over time
```{r}





plot(new$shell.wt ~ new$end, pch = 19, col = as.factor(new$sal.treat))
plot(new$orgC.shell.wt ~ new$med.ta, pch = 19, col = as.factor(new$TA.treat))
boxplot(new$`%oc.ic.shell`~new$TA.treat + new$sal.treat, pch = 19, col = as.factor(new$TA.treat))
plot(new$`%oc.ic.shell`~new$diff, pch = 19, col = as.factor(new$TA.treat))


summary(lme(`%oc.ic.shell`~ med.ta + med.S, data = gro, random = ~1|bucket))


plot(new$mid.diff.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$mid.end.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$delta.rates ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))

```

looking at final params across axes
```{r}
#gut
plot(gro$gut.wt ~ gro$med.S)
plot(gro$gut.wt ~ gro$med.ta)

summary(lme(gut.wt ~ med.S + med.ta, random = ~1|bucket, data = gro)) #unclustered data; no effect of S or TA on gut wt

boxplot(gro$gut.wt ~ gro$sal.treat)
boxplot(gro$gut.wt ~ gro$TA.treat)

summary(aov(gro$gut.wt ~ gro$sal.treat + gro$TA.treat)) #clustering by treatment leads to no effect of S or TA

#shell weight
plot(gro$shell.wt ~ gro$med.S)
plot(gro$shell.wt ~ gro$med.ta)

summary(lme(shell.wt ~ med.S + med.ta, random = ~1|bucket, data = gro)) #unclustered data; no effect of S or TA on shell wt

summary(aov(gro$shell.wt ~ gro$sal.treat + gro$TA.treat)) #clustering by treatment leads to no effect of S or TA

#organic mass
plot(gro$orgC.shell.wt ~ gro$med.S)
plot(gro$orgC.shell.wt ~ gro$med.ta)

summary(lme(orgC.shell.wt ~ med.S + med.ta, random = ~1|bucket, data = gro)) #unclustered data; no effect of S and SIG effect of TA on orgC wt in shell

summary(aov(gro$orgC.shell.wt ~ gro$sal.treat + gro$TA.treat)) #clustering by treatment leads to no effect of S and SIG effect of TA on the orgC wt in shell

#org carbon as % total wt
plot(gro$`%oc.ic.shell` ~ gro$med.S)
plot(gro$`%oc.ic.shell` ~ gro$med.ta)

summary(lme((`%oc.ic.shell`) ~ med.S + med.ta, random = ~1|bucket, data = gro)) #unclustered data; NEED TO FIX CODE

summary(aov(gro$`%oc.ic.shell` ~ gro$sal.treat + gro$TA.treat)) #clustering by treatment leads to no effect of S and SIG effect of TA on the %orgC wt in shell

#CI
plot(gro$CI ~ gro$med.S)
plot(gro$CI ~ gro$med.ta)

summary(lme(CI ~ med.S + med.ta, random = ~1|bucket, data = gro)) #unclustered data; NO EFFECT OF EITHER

boxplot(gro$CI ~ gro$sal.treat)
boxplot(gro$CI ~ gro$TA.treat)

summary(aov(gro$CI ~ gro$sal.treat + gro$TA.treat)) #clustering by treatment leads to a SIG effect of S and SIG effect of TA on the condition index (gut.wt/shell.wt)
library(rstatix)
aov(gro$CI ~ gro$sal.treat + gro$TA.treat) %>% TukeyHSD() #CI highest in TA 2000 treatment and no diff between 1000 and 3000 treat


#gut wt to shell wt ratio

#shell SA to shell wt ratio

#first 2 weeks of acclimating: growth rate
plot(new$mid.diff.perc, pch = 19) 
boxplot(new$mid.diff.perc ~ new$TA.treat + new$sal.treat, ylab = "growth rate for first two weeks") 
abline(h=0)# values above 0 mean that oysters had net growth


#second 2 weeks post acclimating: growth rate
plot(new$mid.end.perc, pch = 19) 
boxplot(new$mid.end.perc ~ new$TA.treat + new$sal.treat, ylab = "growth rate for second two weeks") 
abline(h=0)# values above 0 mean oysters had net growth


#full experiment growth rate
plot(new$diff.perc, pch = 19) 
boxplot(as.numeric(new$diff.perc) ~ new$TA.treat + new$sal.treat, ylab = "growth rate over duration of experiment") 
abline(h=0)# values above 0 mean that oysters had new growth

#difference in growth rate from acclim to post acclim
plot(new$delta.rates, pch = 19) 
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19, ylab = "change in growth rate after acclimation") 
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
plot(new$delta.rates ~ new$med.ta, pch = 19, col = as.factor(new$sal.treat))

```



