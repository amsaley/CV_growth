#setwd("/Users/alishamsaley/Documents/GitHub/CV_growth/data files")
setwd("~/Documents/Data_Git Hub/Mussels/CV_growth/data files")
setwd("~/GitHub/CV_growth")
setwd("~/GitHub/CV_growth/data files")
library(readxl)
sw = read_xlsx("treatment monitoring.xlsx")
gro = read_xlsx("CV mass data.xlsx")
gro = gro[gro$CV_ID != "bucket 4" & gro$CV_ID != "bucket 6",]
gro$bucket = as.numeric(gro$`Bucket#`)
sa = read_xlsx("CV SA practice.xlsx")
#adding new column for CI.gutwt.shellwt
gro$CI = gro$gut.wt/gro$shell.wt
boxplot(sw[sw$fresh_old == "fresh",]$S ~ sw[sw$fresh_old == "fresh",]$`Bucket#`)
boxplot(sw$T_c ~ sw$`Bucket#`)
boxplot(sw[sw$fresh_old == "fresh",]$pH ~ sw[sw$fresh_old == "fresh",]$`Bucket#`)
boxplot(sw[sw$fresh_old == "fresh",]$DO_sat ~ sw[sw$fresh_old == "fresh",]$`Bucket#`)
boxplot(sw[sw$fresh_old == "fresh",]$TA ~ sw[sw$fresh_old == "fresh",]$`Bucket#`)
plot(sw$TA~sw$`Bucket#`)
boxplot(sw[sw$fresh_old == "fresh",]$TA ~ sw[sw$fresh_old == "fresh",]$TA.treat)
boxplot(sw[sw$fresh_old == "fresh",]$S ~ sw[sw$fresh_old == "fresh",]$Sal.treat)
#calculating medians TA
b1.ta = median(sw[sw$`Bucket#` == 1 & sw$fresh_old == "fresh" ,]$TA)
b2.ta = median(sw[sw$`Bucket#` == 2& sw$fresh_old == "fresh" ,]$TA)
b3.ta = median(sw[sw$`Bucket#` == 3& sw$fresh_old == "fresh" ,]$TA)
b4.ta = median(sw[sw$`Bucket#` == 4& sw$fresh_old == "fresh" ,]$TA)
b5.ta = median(sw[sw$`Bucket#` == 5& sw$fresh_old == "fresh" ,]$TA)
b6.ta = median(sw[sw$`Bucket#` == 6 & sw$fresh_old == "fresh" ,]$TA)
b7.ta = median(sw[sw$`Bucket#` == 7& sw$fresh_old == "fresh" ,]$TA)
b8.ta = median(sw[sw$`Bucket#` == 8& sw$fresh_old == "fresh" ,]$TA)
b9.ta = median(sw[sw$`Bucket#` == 9& sw$fresh_old == "fresh" ,]$TA)
b10.ta = median(sw[sw$`Bucket#` == 10& sw$fresh_old == "fresh" ,]$TA)
b11.ta = median(sw[sw$`Bucket#` ==11& sw$fresh_old == "fresh" ,]$TA)
b12.ta = median(sw[sw$`Bucket#` == 12& sw$fresh_old == "fresh" ,]$TA)
b13.ta = median(sw[sw$`Bucket#` == 13& sw$fresh_old == "fresh" ,]$TA)
b14.ta = median(sw[sw$`Bucket#` == 14& sw$fresh_old == "fresh" ,]$TA)
#adding a column to gro TA
gro$med.ta = 0
gro$med.ta[gro$`Bucket#` == 1] <- b1.ta
gro$med.ta[gro$`Bucket#` == 2] <- b2.ta
gro$med.ta[gro$`Bucket#` == 3] <- b3.ta
gro$med.ta[gro$`Bucket#` == 4] <- b4.ta
gro$med.ta[gro$`Bucket#` == 5] <- b5.ta
gro$med.ta[gro$`Bucket#` == 6] <- b6.ta
gro$med.ta[gro$`Bucket#` == 7] <- b7.ta
gro$med.ta[gro$`Bucket#` == 8] <- b8.ta
gro$med.ta[gro$`Bucket#` == 9] <- b9.ta
gro$med.ta[gro$`Bucket#` == 10] <- b10.ta
gro$med.ta[gro$`Bucket#` == 11] <- b11.ta
gro$med.ta[gro$`Bucket#` == 12] <- b12.ta
gro$med.ta[gro$`Bucket#` == 13] <- b13.ta
gro$med.ta[gro$`Bucket#` == 14] <- b14.ta
#calculating medians SAL
b1.S = median(sw[sw$`Bucket#` == 1,]$S)
b2.S = median(sw[sw$`Bucket#` == 2,]$S)
b3.S = median(sw[sw$`Bucket#` == 3,]$S)
b4.S = median(sw[sw$`Bucket#` == 4,]$S)
b5.S = median(sw[sw$`Bucket#` == 5,]$S)
b6.S = median(sw[sw$`Bucket#` == 6,]$S)
b7.S = median(sw[sw$`Bucket#` == 7,]$S)
b8.S = median(sw[sw$`Bucket#` == 8,]$S)
b9.S = median(sw[sw$`Bucket#` == 9,]$S)
b10.S = median(sw[sw$`Bucket#` == 10,]$S)
b11.S = median(sw[sw$`Bucket#` ==11,]$S)
b12.S = median(sw[sw$`Bucket#` == 12,]$S)
b13.S = median(sw[sw$`Bucket#` == 13,]$S)
b14.S = median(sw[sw$`Bucket#` == 14,]$S)
#adding a column to gro
gro$med.S = 0
gro$med.S[gro$`Bucket#` == 1] <- b1.S
gro$med.S[gro$`Bucket#` == 2] <- b2.S
gro$med.S[gro$`Bucket#` == 3] <- b3.S
gro$med.S[gro$`Bucket#` == 4] <- b4.S
gro$med.S[gro$`Bucket#` == 5] <- b5.S
gro$med.S[gro$`Bucket#` == 6] <- b6.S
gro$med.S[gro$`Bucket#` == 7] <- b7.S
gro$med.S[gro$`Bucket#` == 8] <- b8.S
gro$med.S[gro$`Bucket#` == 9] <- b9.S
gro$med.S[gro$`Bucket#` == 10] <- b10.S
gro$med.S[gro$`Bucket#` == 11] <- b11.S
gro$med.S[gro$`Bucket#` == 12] <- b12.S
gro$med.S[gro$`Bucket#` == 13] <- b13.S
gro$med.S[gro$`Bucket#` == 14] <- b14.S
#gro + controls
gro.full = gro
#omitting control oysters
gro = gro[gro$med.S > 0 & gro$med.ta > 0,]
new = cbind(gro,sa)
new = new[new$diff.perc > -50,]
plot(new$diff.perc ~ new$med.ta, col = as.factor(new$sal.treat), pch = 19)
new = new[new$code == 0,]
plot(new$shell.wt ~ new$end, pch = 19, col = as.factor(new$sal.treat))
plot(new$orgC.shell.wt ~ new$med.ta, pch = 19, col = as.factor(new$TA.treat))
boxplot(new$`%oc.ic.shell`~new$TA.treat, pch = 19, col = as.factor(new$TA.treat))
plot(new$`%oc.ic.shell`~new$diff, pch = 19, col = as.factor(new$TA.treat))
summary(lme(`%oc.ic.shell`~ med.ta + med.S, data = gro, random = ~1|bucket))
library(lme4)
summary(lme(`%oc.ic.shell`~ med.ta + med.S, data = gro, random = ~1|bucket))
new = new[new$diff.perc > -50,]
plot(new$shell.wt ~ new$end, pch = 19, col = as.factor(new$sal.treat))
#omitting CV that fell off?
new = new[new$CV_ID != c(149,150,161,174,192,203,205,218,223,241,296,297,298,300,301,306,311,320,326,327,329,337,348,360,367,387,388,419,437,442,464,465,466,468,470,472,473,479,482,485,491,517,541,542,544,549,561,564,566,567,570,571,577,578,581),]
#omitting CV that fell off?
new = new[new$CV_ID != &
#omitting CV that fell off?
new = new[  new$CV_ID != 149 &
new$CV_ID != 150 &
new$CV_ID != 161 &
new$CV_ID != 174 &
new$CV_ID != 192 &
new$CV_ID != 203 &
new$CV_ID != 205 &
new$CV_ID != 218 &
new$CV_ID != 223 &
new$CV_ID != 241 &
new$CV_ID != 296 &
new$CV_ID != 297 &
new$CV_ID != 298 &
new$CV_ID != 300 &
new$CV_ID != 301 &
new$CV_ID != 306 &
new$CV_ID != 311 &
new$CV_ID != 320 &
new$CV_ID != 326 &
new$CV_ID != 327 &
new$CV_ID != 329 &
new$CV_ID != 337 &
new$CV_ID != 348 &
new$CV_ID != 360 &
new$CV_ID != 367 &
new$CV_ID != 387 &
new$CV_ID != 388 &
new$CV_ID != 419 &
new$CV_ID != 437 &
new$CV_ID != 442 &
new$CV_ID != 464 &
new$CV_ID != 465 &
new$CV_ID != 466 &
new$CV_ID != 468 &
new$CV_ID != 470 &
new$CV_ID != 472 &
new$CV_ID != 473 &
new$CV_ID != 479 &
new$CV_ID != 482 &
new$CV_ID != 485 &
new$CV_ID != 491 &
new$CV_ID != 517 &
new$CV_ID != 541 &
new$CV_ID != 542 &
new$CV_ID != 544 &
new$CV_ID != 549 &
new$CV_ID != 561 &
new$CV_ID != 564 &
new$CV_ID != 566 &
new$CV_ID != 567 &
new$CV_ID != 570 &
new$CV_ID != 571 &
new$CV_ID != 577 &
new$CV_ID != 578 &
new$CV_ID != 581,]
plot(new$diff, pch = 19)
#omitting CV that fell off?
new = new[new$CV_ID != 146 &
new$CV_ID != 149 &
new$CV_ID != 150 &
new$CV_ID != 161 &
new$CV_ID != 174 &
new$CV_ID != 192 &
new$CV_ID != 203 &
new$CV_ID != 205 &
new$CV_ID != 218 &
new$CV_ID != 223 &
new$CV_ID != 241 &
new$CV_ID != 296 &
new$CV_ID != 297 &
new$CV_ID != 298 &
new$CV_ID != 300 &
new$CV_ID != 301 &
new$CV_ID != 306 &
new$CV_ID != 311 &
new$CV_ID != 320 &
new$CV_ID != 326 &
new$CV_ID != 327 &
new$CV_ID != 329 &
new$CV_ID != 337 &
new$CV_ID != 348 &
new$CV_ID != 360 &
new$CV_ID != 367 &
new$CV_ID != 387 &
new$CV_ID != 388 &
new$CV_ID != 403 &
new$CV_ID != 409 &
new$CV_ID != 419 &
new$CV_ID != 437 &
new$CV_ID != 442 &
new$CV_ID != 464 &
new$CV_ID != 465 &
new$CV_ID != 466 &
new$CV_ID != 468 &
new$CV_ID != 470 &
new$CV_ID != 472 &
new$CV_ID != 473 &
new$CV_ID != 479 &
new$CV_ID != 482 &
new$CV_ID != 485 &
new$CV_ID != 491 &
new$CV_ID != 517 &
new$CV_ID != 541 &
new$CV_ID != 542 &
new$CV_ID != 544 &
new$CV_ID != 549 &
new$CV_ID != 561 &
new$CV_ID != 564 &
new$CV_ID != 566 &
new$CV_ID != 567 &
new$CV_ID != 570 &
new$CV_ID != 571 &
new$CV_ID != 577 &
new$CV_ID != 578 &
new$CV_ID != 581,]
plot(new$diff, pch = 19)
plot(new$diff ~ new$mid.diff)
plot(new$diff.perc ~ new$mid.diff.perc, pch = 19)
abline(0,1)
plot(new$diff.perc, pch = 19)
points(new$mid.diff.perc, pch = 19, col = "blue")
points(new$mid.end.perc, pch = 19, col = "dark green")
plot(new$diff.perc, pch = 19, bty = "n")
plot(new$diff.perc, pch = 19, pch = NA)
points(new$mid.diff.perc, pch = 19, col = "blue")
plot(new$diff.perc, pch = 19)
plot(new$diff.perc, pch = 19, col = "white")
points(new$mid.diff.perc, pch = 19, col = "blue")
points(new$mid.end.perc, pch = 19, col = "dark green")
new$delta.rates = new$mid.end.perc - new$mid.diff.perc
plot(new$delta.rates, pch = 19)
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19)
boxplot(new$delta.rates ~ new$sal.treat + new$TA.treat, pch = 19)
boxplot(new$`%oc.ic.shell`~new$TA.treat + new$sal.treat, pch = 19, col = as.factor(new$TA.treat))
summary(anova(new$`%oc.ic.shell`~new$TA.treat + new$sal.treat))
lm(anova(new$`%oc.ic.shell`~new$TA.treat + new$sal.treat))
summary(lm(new$`%oc.ic.shell`~new$TA.treat + new$sal.treat))
summary(lme(new$`%oc.ic.shell`~new$TA.treat + new$sal.treat, random = ~1|bucket))
summary(lmer(new$`%oc.ic.shell`~new$TA.treat + new$sal.treat, random = ~1|bucket))
#difference in growth rate from acclim to post acclim
plot(new$delta.rates, pch = 19)
#difference in growth rate from acclim to post acclim
plot(new$delta.rates, pch = 19) # values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
#difference in growth rate from acclim to post acclim
plot(new$delta.rates ~ new$med.S, pch = 19)
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
plot(new$delta.rates ~ new$med.ta, pch = 19)
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
plot(new$delta.rates ~ new$med.ta, pch = 19, col = as.factor(new$sal.treat))
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
boxplot(new$delta.rates ~ new$med.ta, pch = 19, col = as.factor(new$sal.treat))
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
boxplot(new$delta.rates ~ new$med.ta + new$med.S, pch = 19)
boxplot(new$delta.rates ~ new$med.ta + new$sal.treat, pch = 19)
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19)
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
#difference in growth rate from acclim to post acclim
plot(new$delta.rates, pch = 19)
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19)
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
#full experiment growth rate
plot(new$diff.perc, pch = 19)
boxplot(new$diff.perc ~ new$TA.treat + new$sal.treat, pch = 19)
boxplot(new$diff.perc ~ new$TA.treat + new$sal.treat, pch = 19)
boxplot(new$diff.perc ~ new$TA.treat + new$sal.treat)
boxplot(as.numeric(new$diff.perc) ~ new$TA.treat + new$sal.treat)
#second 2 weeks post acclimating: growth rate
plot(new$mid.end.perc, pch = 19)
#full experiment growth rate
plot(new$diff.perc, pch = 19)
#second 2 weeks post acclimating: growth rate
plot(new$mid.end.perc, pch = 19)
boxplot(new$mid.end.perc ~ new$TA.treat + new$sal.treat)
#first 2 weeks of acclimating: growth rate
plot(new$mid.diff.perc, pch = 19)
boxplot(new$mid.diff.perc ~ new$TA.treat + new$sal.treat)
boxplot(new$mid.end.perc ~ new$TA.treat + new$sal.treat)
boxplot(new$mid.diff.perc ~ new$TA.treat + new$sal.treat, ylab = "growth rate for first two weeks")
#second 2 weeks post acclimating: growth rate
plot(new$mid.end.perc, pch = 19)
boxplot(new$mid.end.perc ~ new$TA.treat + new$sal.treat, ylab = "growth rate for second two weeks")
boxplot(as.numeric(new$diff.perc) ~ new$TA.treat + new$sal.treat, ylab = "growth rate over duration of experiment")
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19, ylab = "change in growth rate after acclimation")
abline(h=0)
boxplot(new$mid.diff.perc ~ new$TA.treat + new$sal.treat, ylab = "growth rate for first two weeks")
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
boxplot(new$mid.diff.perc ~ new$TA.treat + new$sal.treat, ylab = "growth rate for first two weeks")
abline(h=0)# values above 0 mean that oysters had net growth
#second 2 weeks post acclimating: growth rate
plot(new$mid.end.perc, pch = 19)
boxplot(new$mid.end.perc ~ new$TA.treat + new$sal.treat, ylab = "growth rate for second two weeks")
abline(h=0)# values above 0 mean oysters had net growth
boxplot(as.numeric(new$diff.perc) ~ new$TA.treat + new$sal.treat, ylab = "growth rate over duration of experiment")
abline(h=0)# values above 0 mean that oysters had new growth
#difference in growth rate from acclim to post acclim
plot(new$delta.rates, pch = 19)
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19, ylab = "change in growth rate after acclimation")
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
plot(new$delta.rates ~ new$med.ta, pch = 19, col = as.factor(new$sal.treat))
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19, ylab = "change in growth rate after acclimation")
plot(new$med.ta ~ new$TA.treat)
plot(new$med.ta ~ new$TA.treat, pch = 19, col = new$sal.treat)
plot(new$med.ta ~ new$TA.treat, pch = 19, col = as.factor(new$sal.treat))
plot(new$med.ta ~ new$TA.treat, pch = 19, col = as.factor(new$sal.treat), cex = 2)
boxplot(sw[sw$fresh_old == "fresh",]$TA ~ sw[sw$fresh_old == "fresh",]$`Bucket#`)
boxplot(sw[sw$fresh_old == "fresh",]$TA ~ sw[sw$fresh_old == "fresh",]$`Bucket#`, col = as.factor(sw$TA.treat))
#difference in growth rate from acclim to post acclim
plot(new$delta.rates, pch = 19)
#difference in growth rate from acclim to post acclim
plot(new$delta.rates ~new$`Bucket#`, pch = 19)
#difference in growth rate from acclim to post acclim
plot(new$delta.rates, pch = 19)
abline(h=0)# values above 0 mean that growth rate increased after acclim and anything less than 0 means that growth rate was higher during acclimation
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19, ylab = "change in growth rate after acclimation")
plot(new$TA.treat ~ new$`Bucket#`)
plot(new$TA.treat ~ new$`Bucket#`, pch = 19)
plot(new$TA.treat ~ new$`Bucket#`, pch = 19, col = as.factor(new$sal.treat))
plot(sw$T_c ~ sw$`Bucket#`)
plot(new$shell.wt ~ new$med.ta, pch = 19, col = as.factor(new$sal.treat))
plot(new$shell.wt ~ new$`Bucket#`, pch = 19, col = as.factor(new$sal.treat))
plot(new$orgC.shell.wt ~ new$`Bucket#`, pch = 19, col = as.factor(new$sal.treat))
plot(new$orgC.shell.wt ~ new$med.ta, pch = 19, col = as.factor(new$sal.treat))
unique(new$med.ta)
plot(new$orgC.shell.wt ~ jitter(new$med.ta,400), pch = 19, col = as.factor(new$sal.treat))
plot(new$orgC.shell.wt ~ jitter(new$med.ta,200), pch = 19, col = as.factor(new$sal.treat))
plot(new$orgC.shell.wt ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$shell.wt ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$CI ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$diff.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$mid.diff.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$mid.end.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$mid.diff.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$mid.end.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$delta.rates ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
abline(h=0)
plot(new$med.ta, new$med.S)
plot(new$shell.wt)
plot(new$delta.rates ~ new$shell.wt)
plot(new$delta.rates ~ new$shell.wt, col = as.factor(new$sal.treat))
plot(new$delta.rates ~ new$shell.wt, col = as.factor(new$TA.treat))
plot(new$delta.rates ~ new$shell.wt, col = as.factor(new$TA.treat), pch = 19)
plot(new$delta.rates ~ new$end, col = as.factor(new$TA.treat), pch = 19)
plot(new$mid.diff.perc ~ new$end, col = as.factor(new$TA.treat), pch = 19)
plot(new$mid.diff.perc ~ new$end, col = as.factor(new$sal.treat), pch = 19)
plot(new$end ~ new$shell.wt)
new = new[new$end < 200 & new$shell.wt < 600,]
plot(new$end ~ new$shell.wt)
plot(new$end ~ new$shell.wt, pch = 19, col = as.factor(new$sal.treat))
plot(new$end ~ new$shell.wt, pch = 19, col = as.factor(new$ta.treat))
plot(new$end ~ new$shell.wt, pch = 19, col = as.factor(new$ta.treat))
unique(new$TA.treat)
plot(new$end ~ new$shell.wt, pch = 19)
plot(new$end ~ new$shell.wt, pch = 19, col = as.factor(new$TA.treat))
plot(new$end ~ new$CI, pch = 19, col = as.factor(new$TA.treat))
plot(new$mid.diff.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$mid.end.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$mid.diff.perc ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
plot(new$delta.rates ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
abline(h=0)
boxplot(new$delta.rates ~ jitter(new$med.ta,100), pch = 19, col = as.factor(new$sal.treat))
boxplot(new$delta.rates ~ jitter(new$TA.treat,100), pch = 19, col = as.factor(new$sal.treat))
boxplot(new$delta.rates ~ new$TA.treat, pch = 19, col = as.factor(new$sal.treat))
boxplot(new$delta.rates ~ new$TA.treat + new$sal.treat, pch = 19)
boxplot(new$delta.rates ~ new$sal.treat +  new$TA.treat, pch = 19)
