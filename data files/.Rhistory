library(dplyr)
remove.packages(rlang)
remove.packages("rlang")
install.packages("rlang")
install.packages("rlang")
packageVersion("rlang")
library("rlang")
library(rlang)
library(dplyr)
install.packages("rlang")
setwd("C:/Users/alish/OneDrive/Documents/GitHub/CV_growth/data files")
library(readxl)
library(lme4)
library(lmerTest)
dat = read.csv("C:/Users/alish/OneDrive/Documents/GitHub/CV_growth/data files/dat.processed.csv")
control = read_xlsx("control cv.xlsx")
dat$T. = 0
dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == "1000",]$T. <- "T1"
dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == "2000",]$T. = "T2"
dat[dat$sal.treat.x == "amb" & dat$TA.treat.x == "3000",]$T. = "T3"
dat[dat$sal.treat.x == "low" & dat$TA.treat.x == "1000",]$T. = "t1"
dat[dat$sal.treat.x == "low" & dat$TA.treat.x == "2000",]$T. = "t2"
dat[dat$sal.treat.x == "low" & dat$TA.treat.x == "3000",]$T. = "t3"
nT1 = nrow(dat[dat$T. == "T1" & dat$dps == 36,])
nT2 = nrow(dat[dat$T. == "T2" & dat$dps == 36,])
nT3 = nrow(dat[dat$T. == "T3" & dat$dps == 36,])
nt1 = nrow(dat[dat$T. == "t1" & dat$dps == 36,])
nt2 = nrow(dat[dat$T. == "t2" & dat$dps == 36,])
nt3 = nrow(dat[dat$T. == "t3" & dat$dps == 36,])
dat$nrow = 0
dat[dat$T. == "T1",]$nrow <- nT1
dat[dat$T. == "T2",]$nrow <- nT2
dat[dat$T. == "T3",]$nrow <- nT3
dat[dat$T. == "t1",]$nrow <- nt1
dat[dat$T. == "t2",]$nrow <- nt2
dat[dat$T. == "t3",]$nrow <- nt3
#after 5 weeks of exposure
end = dat[dat$dps == 36,]
end$Net_growth.w.trans = log(end$Net_growth.w + 10)
plot((Net_growth.w.trans) ~ med.ta, pch = 19, col = as.factor(sal.treat.x), data = end)
#for incremental growth we need to delete the first time step
inc = subset(dat,
dps >1)
sw = read_xlsx("treatment monitoring.xlsx")
setwd("C:/Users/alish/OneDrive/Documents/GitHub/CV_growth/data files")
library(readxl)
library(lme4)
library(lmerTest)
sw = read_xlsx("treatment monitoring.xlsx")
mass = read_xlsx("CV mass data_V1.xlsx")
mass = mass[mass$CV_ID != "bucket 4" & mass$CV_ID != "bucket 6",]
mass$CI = mass$gut.wt/mass$shell.wt
mass$bucket = as.numeric(mass$`Bucket#`)
#code scores
#1 = blank tinfoil measurements
#2 = no gut but only shell weights
#3 = ID missing for CV
#4 = bad data
mass = mass[mass$code == 0,]
sa = read_xlsx("all SA growth data_V1.xlsx")
control = read_xlsx("control cv.xlsx")
library(seacarb)
#inputting another column for salinity
sw$ph.spec = NA
sw[sw$S > 31,]$ph.spec <- round((0.0221*sw[sw$S > 31,]$pH.mV) + 6.6854,2)
sw[sw$S < 31,]$ph.spec <- round((0.019*sw[sw$S < 31,]$pH.mV) + 6.7915,2)
sw$ph.spec = as.numeric(sw$ph.spec)
#calculating the rest of sea carb using TA and pH measurements
carb = carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)
plot(carb$pH ~ carb$OmegaCalcite)
sw$Om_a = carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$OmegaAragonite
sw$Om_c= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$OmegaCalcite
sw$DIC= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$DIC
sw$PCO2= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$PCO2
plot(sw$ph.spec ~ sw$TA)
plot(sw$ph.spec ~ sw$TA, pch = as. factor(sw$Sal.treat))
plot(sw$ph.spec ~ sw$TA, pch = as.factor(sw$Sal.treat))
plot(sw$ph.spec ~ sw$TA, pch = 19, col =  as.factor(sw$Sal.treat))
points(ph.spec ~ TA, data = sw[sw$fresh_old == "fresh",],pch = 19, col =  as.factor(sw$Sal.treat), cex = 1.5)
points(ph.spec ~ TA, data = sw[sw$fresh_old == "old",],pch = 19, col =  as.factor(sw$Sal.treat), cex = 1.5)
points(ph.spec ~ TA, data = sw[sw$fresh_old == "fresh",],pch = 17, col =  as.factor(sw$Sal.treat), cex = 1.5)
plot(ph.spec ~ TA, data = sw[sw$fresh_old == "fresh",],pch = 17, col =  as.factor(sw$Sal.treat), cex = 1.5)
points(ph.spec ~ TA, data = sw[sw$fresh_old == "old",],pch = 19, col =  as.factor(sw$Sal.treat), cex = 1.5)
plot(ph.spec ~ TA, data = sw[sw$fresh_old == "fresh",],pch = 17, col =  as.factor(sw$Sal.treat), cex = 1.5)
sw.control = subset(sw,`Bucket#` == 7 &
`Bucket#`== 14)
sw = read_xlsx("treatment monitoring.xlsx")
unique(sw$`Bucket#`)
#inputting another column for salinity
sw$ph.spec = NA
sw[sw$S > 31,]$ph.spec <- round((0.0221*sw[sw$S > 31,]$pH.mV) + 6.6854,2)
sw[sw$S < 31,]$ph.spec <- round((0.019*sw[sw$S < 31,]$pH.mV) + 6.7915,2)
sw$ph.spec = as.numeric(sw$ph.spec)
#calculating the rest of sea carb using TA and pH measurements
carb = carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)
plot(carb$pH ~ carb$OmegaCalcite)
sw$Om_a = carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$OmegaAragonite
sw$Om_c= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$OmegaCalcite
sw$DIC= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$DIC
sw$PCO2= carb(flag = 8, var1 = sw$ph.spec, var2 = sw$TA/10^6, T = sw$T_c, S = sw$S)$PCO2
sw.control = subset(sw,`Bucket#` == 7 &
`Bucket#`== 14)
sw.control = subset(sw,`Bucket#` == 7,
`Bucket#`== 14)
sw.control = subset(sw,
`Bucket#` == 7,
`Bucket#`== 14)
sw.control = subset(sw,
`Bucket#` == 7|
`Bucket#`== 14)
boxplot(sw.control$ph.spec ~ sw.control$fresh_old)
plot(sw.control$ph.spec ~ sw.control$dps)
plot(sw.control$ph.spec ~ sw.control$Date)
plot(sw.control$ph.spec ~ sw.control$Date, col = as.factor(sw.control$fresh_old))
plot(sw.control$ph.spec ~ sw.control$Date, col = as.factor(sw.control$fresh_old), pch = 19)
points(ph.spec ~ Date, col = as.factor(fresh_old), data = sw.control[sw.control$`Bucket#` == 7,] pch = 19)
points(ph.spec ~ Date, col = as.factor(fresh_old), data = sw.control[sw.control$`Bucket#` == 7,], pch = 19)
points(ph.spec ~ Date, col = as.factor(fresh_old), data = sw.control[sw.control$`Bucket#` == 7,], pch = 19, cex = 1.5)
points(ph.spec ~ Date, col = as.factor(fresh_old), data = sw.control[sw.control$`Bucket#` == 14,], pch = 19, cex = 1.5)
plot(sw.control$ph.spec ~ sw.control$Date, col = as.factor(sw.control$fresh_old), pch = 19)
points(ph.spec ~ Date, col = as.factor(fresh_old), data = sw.control[sw.control$`Bucket#` == 14,], pch = 19, cex = 1.5)
plot(sw.control$ta ~ sw.control$Date, col = as.factor(sw.control$fresh_old), pch = 19)
plot(sw.control$TA ~ sw.control$Date, col = as.factor(sw.control$fresh_old), pch = 19)
plot(dat$med.ta ~ dat$med.S)
abline(h = c(850,1000,1500,1900,2100,2800))
abline(h = 800)
abline(h = 1950)
abline(h = 2200)
abline(h = 2900)
34-27
(2250-800)/7
207*27
(2250-1500)/7
(2250-2200)/7
plot(x = c(1, 34), y = c(0,5000))
points(x = c(27,27,27), y = c(800,1500,2200))
points(x = c(27,27,27,34), y = c(800,1500,2200,2250), pch = 19)
abline(0,107)
abline(0,50)
abline(0,60)
abline(0,65)
abline(0,66)
abline(0,67)
plot(sw$DO_sat)
abline(h=85)
sw2 = subset(sw,
`Bucket#` != 7 &
`Bucket#`!= 14)
sw = sw2
plot(sw$DO_sat)
abline(h=80)
sw[sw$DO_sat < 80,]$`Bucket#`
sw[sw$DO_sat < 80,]$Date
