library(dplyr)
remove.packages(rlang)
remove.packages("rlang")
install.packages("rlang")
install.packages("rlang")
packageVersion("rlang")
library("rlang")
library(rlang)
library(dplyr)
install.packages("rlang")
setwd("C:/Users/alish/OneDrive/Documents/GitHub/CV_growth/data files")
library(readxl)
library(lme4)
library(lmerTest)
sw = read_xlsx("treatment monitoring.xlsx")
mass = read_xlsx("CV mass data_V1.xlsx")
mass = mass[mass$CV_ID != "bucket 4" & mass$CV_ID != "bucket 6",]
mass$CI = mass$gut.wt/mass$shell.wt
mass$bucket = as.numeric(mass$`Bucket#`)
#code scores
#1 = blank tinfoil measurements
#2 = no gut but only shell weights
#3 = ID missing for CV
#4 = bad data
mass = mass[mass$code == 0,]
sa = read_xlsx("all SA growth data_V1.xlsx")
#adding a column to gro TA
mass$med.ta = 0
mass$med.ta[mass$`Bucket#` == 1] <- median(sw[sw$`Bucket#` == 1& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 2] <- median(sw[sw$`Bucket#` == 2& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 3] <- median(sw[sw$`Bucket#` == 3& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 4] <- median(sw[sw$`Bucket#` == 4& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 5] <- median(sw[sw$`Bucket#` == 5& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 6] <- median(sw[sw$`Bucket#` == 6& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 7] <- median(sw[sw$`Bucket#` == 7& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 8] <- median(sw[sw$`Bucket#` == 8& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 9] <- median(sw[sw$`Bucket#` == 9& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 10] <- median(sw[sw$`Bucket#` == 10& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 11] <- median(sw[sw$`Bucket#` == 11& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 12] <- median(sw[sw$`Bucket#` == 12& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 13] <- median(sw[sw$`Bucket#` == 13& sw$fresh_old == "fresh",]$TA)
mass$med.ta[mass$`Bucket#` == 14] <- median(sw[sw$`Bucket#` == 14& sw$fresh_old == "fresh",]$TA)
#adding a column to gro S
mass$med.S = 0
mass$med.S[mass$`Bucket#` == 1] <- median(sw[sw$`Bucket#` == 1,]$S)
mass$med.S[mass$`Bucket#` == 2] <- median(sw[sw$`Bucket#` == 2,]$S)
mass$med.S[mass$`Bucket#` == 3] <- median(sw[sw$`Bucket#` == 3,]$S)
mass$med.S[mass$`Bucket#` == 4] <- median(sw[sw$`Bucket#` == 4,]$S)
mass$med.S[mass$`Bucket#` == 5] <- median(sw[sw$`Bucket#` == 5,]$S)
mass$med.S[mass$`Bucket#` == 6] <- median(sw[sw$`Bucket#` == 6,]$S)
mass$med.S[mass$`Bucket#` == 7] <- median(sw[sw$`Bucket#` == 7,]$S)
mass$med.S[mass$`Bucket#` == 8] <- median(sw[sw$`Bucket#` == 8,]$S)
mass$med.S[mass$`Bucket#` == 9] <- median(sw[sw$`Bucket#` == 9,]$S)
mass$med.S[mass$`Bucket#` == 10] <- median(sw[sw$`Bucket#` == 10,]$S)
mass$med.S[mass$`Bucket#` == 11] <- median(sw[sw$`Bucket#` == 11,]$S)
mass$med.S[mass$`Bucket#` == 12] <- median(sw[sw$`Bucket#` == 12,]$S)
mass$med.S[mass$`Bucket#` == 13] <- median(sw[sw$`Bucket#` == 13,]$S)
mass$med.S[mass$`Bucket#` == 14] <- median(sw[sw$`Bucket#` == 14,]$S)
#adding a column to gro pH (need to correct value still)
mass$med.pH = 0
mass$med.pH[mass$`Bucket#` == 1] <- median(sw[sw$`Bucket#` == 1 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 2] <- median(sw[sw$`Bucket#` == 2 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 3] <- median(sw[sw$`Bucket#` == 3 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 4] <- median(sw[sw$`Bucket#` == 4 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 5] <- median(sw[sw$`Bucket#` == 5 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 6] <- median(sw[sw$`Bucket#` == 6 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 7] <- median(sw[sw$`Bucket#` == 7 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 8] <- median(sw[sw$`Bucket#` == 8 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 9] <- median(sw[sw$`Bucket#` == 9 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 10] <- median(sw[sw$`Bucket#` == 10 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 11] <- median(sw[sw$`Bucket#` == 11 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 12] <- median(sw[sw$`Bucket#` == 12 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 13] <- median(sw[sw$`Bucket#` == 13 & sw$fresh_old == "fresh",]$pH)
mass$med.pH[mass$`Bucket#` == 14] <- median(sw[sw$`Bucket#` == 14 & sw$fresh_old == "fresh",]$pH)
mass.full = mass
#omitting controls
mass = mass[mass$med.S > 0 & mass$med.ta > 0,]
#omitting CV ids that fell off during trial
sa.proc = subset(sa, sa$CV_ID != 581 &
sa$CV_ID != 578 &
sa$CV_ID != 577 &
sa$CV_ID != 571 &
sa$CV_ID != 570 &
sa$CV_ID != 567 &
sa$CV_ID != 566 &
sa$CV_ID != 564 &
sa$CV_ID != 561 &
sa$CV_ID != 549 &
sa$CV_ID != 544 &
sa$CV_ID != 541 &
sa$CV_ID != 537 &
sa$CV_ID != 526 &
sa$CV_ID != 536 &
sa$CV_ID != 534 &
sa$CV_ID != 538 &
sa$CV_ID != 530 &
sa$CV_ID != 517 &
sa$CV_ID != 514 &
sa$CV_ID != 491 &
sa$CV_ID != 482 &
sa$CV_ID != 479 &
sa$CV_ID != 472 &
sa$CV_ID != 470 &
sa$CV_ID != 465 &
sa$CV_ID != 464 &
sa$CV_ID != 462 &
sa$CV_ID != 459 &
sa$CV_ID != 442 &
sa$CV_ID != 437 &
sa$CV_ID != 419 &
sa$CV_ID != 409 &
sa$CV_ID != 405 &
sa$CV_ID != 403 &
sa$CV_ID != 367 &
sa$CV_ID != 360 &
sa$CV_ID != 348 &
sa$CV_ID != 337 &
sa$CV_ID != 334 &
sa$CV_ID != 332 &
sa$CV_ID != 329 &
sa$CV_ID != 326 &
sa$CV_ID != 321 &
sa$CV_ID != 317 &
sa$CV_ID != 313 &
sa$CV_ID != 311 &
sa$CV_ID != 306 &
sa$CV_ID != 305 &
sa$CV_ID != 301 &
sa$CV_ID != 300 &
sa$CV_ID != 299 &
sa$CV_ID != 298 &
sa$CV_ID != 297 &
sa$CV_ID != 296 &
sa$CV_ID != 271 &
sa$CV_ID != 241 &
sa$CV_ID != 223 &
sa$CV_ID != 218 &
sa$CV_ID != 205 &
sa$CV_ID != 203 &
sa$CV_ID != 192 &
sa$CV_ID != 161&
sa$CV_ID != 150 &
sa$CV_ID != 149 &
sa$CV_ID != 146 &
sa$CV_ID != 131 &
sa$CV_ID != 114 &
sa$CV_ID != 91 &
sa$CV_ID != 78 &
sa$CV_ID != 54 &
sa$CV_ID != 42 &
sa$CV_ID != 29 &
sa$CV_ID != 13 &
sa$CV_ID != 7 &
sa$CV_ID != 6)
library(dplyr)
boxplot(sa$SA.mm2 ~ sa$date.numb)
boxplot(sa[sa$sal.treat == "amb" & sa$TA.treat == 1000,]$SA.mm2 ~ sa[sa$sal.treat == "amb" & sa$TA.treat == 1000,]$date.numb)
boxplot(sa[sa$sal.treat == "low" & sa$TA.treat == 3000,]$SA.mm2 ~ sa[sa$sal.treat == "low" & sa$TA.treat == 3000,]$date.numb)
boxplot(sa.proc[sa.proc$sal.treat == "low" & sa.proc$TA.treat == 3000,]$SA.mm2 ~ sa.proc[sa.proc$sal.treat == "low" & sa.proc$TA.treat == 3000,]$date.numb)
boxplot(sa.proc[sa.proc$sal.treat == "low" & sa.proc$TA.treat == 1000,]$SA.mm2 ~ sa.proc[sa.proc$sal.treat == "low" & sa.proc$TA.treat == 1000,]$date.numb)
boxplot(sa.proc[sa.proc$sal.treat == "low",]$SA.mm2 ~ sa.proc[sa.proc$sal.treat == "low",]$date.numb + sa.proc[sa.proc$sal.treat == "low",]$TA.treat)
